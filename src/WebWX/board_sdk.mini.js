!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.BoardSDK=e():t.BoardSDK=e()}(this,function(){return function(t){var e={};function r(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.i=function(t){return t},r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=19)}([function(t,e,r){"use strict";t.exports={decimalToRgba:function(t){var e=[];return t.replace(/../g,function(t){e.push(parseInt(t,16))}),"rgba("+e.join(",")+",1)"},hexToRgba:function(t){var e;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(t))return 3==(e=t.substring(1).split("")).length&&(e=[e[0],e[0],e[1],e[1],e[2],e[2]]),t="#"+e.join(""),"rgba("+parseInt("0x"+t.slice(1,3))+","+parseInt("0x"+t.slice(3,5))+","+parseInt("0x"+t.slice(5,7))+",1)"},rgbaToDecimal:function(t){for(var e=t.toString().match(/\d+/g),r="",i=0;i<3;i++)r+=("0"+Number(e[i]).toString(16)).slice(-2);return r},dealColor:function(t){if(t<0)return"rgba("+(t>>24&255)+","+(t>>16&255)+","+(t>>8&255)+",1)";var e=parseInt(t).toString(16);return e=(e="000000"+(e=e.substr(0,e.length-2))).substring(e.length-6,e.length),this.decimalToRgba(e)},formatColor:function(t){var e=this.rgbaToDecimal(t);return parseInt(e+"ff",16)},getEffectivePoint:function(t,e){return t<=0?t=Math.floor(e/2):t>=1e4&&(t=1e4-Math.floor(e/2)),t},getAVSdkTimestamp:function(){var t=Date.now()+"",e=t.substring(0,5)+"00000000",r=t.substr(5),i=parseInt(e,10).toString(2).substr(-32);return parseInt(i,2)+(4294967295&r)},getTimeStamp:function(){return(new Date).getTime()},getSecondTime:function(){return parseInt(this.getTimeStamp()/1e3)},getTimeDiff:function(t){return(new Date).getTime()-t}}},function(t,e,r){"use strict";t.exports={VERSION:"2.2.3",PLATFORM:"web",SERVER_URL:"https://yun.tim.qq.com/v4/ilvb_edu/whiteboard?contenttype=json&sdkappid=",TEST_SERVER_URL:"https://test.tim.qq.com/v4/ilvb_test/whiteboard?contenttype=json&sdkappid=",COS_SERVER_URL:"https://cloud.tim.qq.com/v4/ilvb_cos/cos",TEST_COS_SERVER_URL:"https://cloud-test.tim.qq.com/v4/ilvb_cos_test/cos",WHITELIST_SERVER_URL:"https://yun.tim.qq.com/v4/ilvb_edu/whitelist?contenttype=json&sdkappid=",TEST_WHITELIST_SERVER_URL:"https://test.tim.qq.com/v4/ilvb_test/whitelist?contenttype=json&sdkappid=",SUB_CMD:{GET_BOARD_DATA:"get_board_data",REPORT_BOARD_DATA:"report_board_data"},COMMON_GROUP:"#DEFAULT",COMMON_DEFAULT_BOARD:"#DEFAULT",THIN:100,RADIUS:100,PROTOCOL_ACTION:{LINE_START_ACTION:1,LINE_MOVE_ACTION:2,LINE_END_ACTION:3,RASER_SHOW_ACTION:6,RASER_HIDE_ACTION:7,ERASER_ACTION:8,MOVE_LINE_GRAPH_ACTION:9,GRAPH_LINE_ACTION:10,GRAPH_CIRCLE_ACTION:11,GRAPH_RECT_ACTION:12,GRAPH_CLEAR_ALL_ACTION:101,GRAPH_CLEAR_ACTION:102,UPDATE_BG_IMG_ACTION:201,DELETE_BG_IMG_ACTION:202,UPDATE_BG_COLOR_ACTION:203,BOARD_MOVE_SCALE_ACTION:301,SWITCH_ACTION:401}}},function(t,e,r){"use strict";function i(){}i.prototype.on=function(t,e){return this._cbs=this._cbs||{},(this._cbs[t]||(this._cbs[t]=[])).unshift(e),this},i.prototype.off=function(t,e){if(this._cbs=this._cbs||{},!t)return this._cbs={};if(!e)return delete this._cbs[t];for(var r,i=this._cbs[t]||[];i&&~(r=i.indexOf(e));)i.splice(r,1);return this},i.prototype.fire=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,e=arguments[1],r=arguments[2];this._cbs=this._cbs||{};var i=this._cbs[e];if(i)for(var o=i.length;o--;)i[o].apply(t,[r]);return this},t.exports=new i},function(t,e,r){"use strict";t.exports={BOARD_ACTION_TYPE:{LINE:"line",ERASER:"eraser",RASER:"raser",POINTSELECT:"pointselect",SELECT:"select",MOVE:"move","GRAPH-LINE":"graph-line","GRAPH-CIRCLE":"graph-circle","GRAPH-RECT":"graph-rect","GRAPH-OVAL":"graph-oval","GRAPH-CIRCLE-SOLID":"graph-circle-solid","GRAPH-RECT-SOLID":"graph-rect-solid","GRAPH-OVAL-SOLID":"graph-oval-solid"},COLOR:{RED:4278190335,WHITE:4294967295},EVENT:{HISTROY_DATA_COMPLETE:"histroy_data_complete",ADD_BOARD:"add_board",RT_DATA:"real_time_data",DELETE_BOARD:"delete_board",SWITCH_BOARD:"switch_board",ADD_FILE:"add_group",DELETE_FILE:"delete_group",SWITCH_FILE:"switch_group",IMG_START_LOAD:"img_start_load",IMG_LOAD:"img_load",IMG_ERROR:"img_error",IMG_ABORT:"img_abort",PRELOAD:"preload",VERIFY_SDK_SUCC:"verify_sdk_succ",VERIFY_SDK_ERROR:"verify_sdk_error",CANVAS_MOUSEDOWN:"canvas_mousedown",CANVAS_MOUSEMOVE:"canvas_mousemove",CANVAS_MOUSEUP:"canvas_mouseup",CANVAS_MOUSELEAVE:"canvas_mouseleave",COS:{GET_SIGN_ERROR:"get_sign_error",TASK_READY:"task_ready",HASH_PROGRESS:"hash_progress",PROGRESS:"progress",GET_SIGN_SUCCESS:"get_sign_success",DOES_NOT_SUPPORT_UPLOAD:"does_not_support_upload",UPLOAD_SUCCESS:"upload_success",UPLOAD_ERROR:"upload_error"}}}},function(t,e,r){"use strict";var i;function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var n=r(0),s=r(1);function a(){}a.prototype={APIURL:"https://ilivelog.qcloud.com",method:"POST",events:{start_draw_curve:"start_draw_curve",move_draw_curve:"move_draw_curve",end_draw_curve:"end_draw_curve",over_draw_curve:"over_draw_curve",start_raser:"start_raser",end_raser:"end_raser",eraser:"eraser",move_scrawl:"move_scrawl",draw_graph:"draw_graph",clear_all:"clear_all",clear_scrawl:"clear_scrawl",set_bg_img:"set_bg_img",clear_bg_img:"clear_bg_img",set_bg_color:"set_bg_color",switch_board:"switch_board",start_select:"start_select",move_select:"move_select",end_select:"end_select",point_select:"point_select"},levels:{info:"info",warn:"warn",error:"error"},send:function(t){try{t.userAgent=navigator.userAgent,t=this.fillDatas(t);var e=this.getXHR();e.onreadystatechange=this.reporterHandel(this),e.open(this.method,this.APIURL,!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.send(JSON.stringify(t))}catch(t){console.log(t)}},fillDatas:function(t){var e={};for(var r in this.defDatas)["sdkappid","classid","userid"].indexOf(r)>=0?e[r]=this.defDatas[r]:e[r]=void 0!==t[r]?t[r]:this.defDatas[r];return e},datasParseToString:function(t){var e=[];for(var r in t)e.push(r+"="+encodeURIComponent(t[r]));return e.join("&")},getXHR:function(){var t=null;if(window.XMLHttpRequest)t=new XMLHttpRequest;else if(window.ActiveXObject)try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}if(null!=t)return t;console.log("Your browser does not support XMLHTTP.")},reporterHandel:function(){return function(t){t&&t.readyState&&t.readyState}},log:function(t,e){this.send({action:t,action_result:e||0,log_msg:t,log_level:this.levels.info})},warn:function(t,e){this.send({action:t,action_result:e||0,log_msg:t,log_level:this.levels.warn})},error:function(t,e){this.send({action:t,action_result:e||0,log_msg:t,log_level:this.levels.error})},defDatas:(i={action:"",version:s.VERSION,action_result:0,action_info:"",userid:"",time_consume:0,sdkappid:"",device:"web",log_time:0,business:"ticsdk",roomid:"",boardid:"",image_url:"",boardid_list:[],to_boardId:"",color:null,file_id:"",file_title:"",isfinish:0,msgLength:20,bucket:"",cos_appid:null,extra_info:"",net_type:"unknown"},o(i,"net_type",null),o(i,"userAgent",null),i),setSdkAppid:function(t){void 0!=t&&null!=t?this.defDatas.sdkappid=t:console.log("sdkappid invalid!")},setRoomId:function(t){void 0!=t&&null!=t?this.defDatas.roomid=t:console.log("roomid invalid!")},setUserId:function(t){void 0!=t&&null!=t?this.defDatas.userid=t:console.log("userid invalid!")},boardAction:function(t,e){this.report(t,e)},report:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{this.send(Object.assign({action_result:0,time_consume:0},e,{action:t,log_time:n.getTimeStamp()}))}catch(t){}}},t.exports=new a},function(t,e,r){"use strict";var i=r(12);t.exports={seq:0,getSeq:function(){var t=Math.round((new Date).getTime()/1e3);return 1*new i(t>>>0<<15|32767&this.seq++,t>>>0>>17).toString()}}},function(t,e,r){"use strict";var i=r(0);t.exports=function(t,e){this.user=t,this.type="graph",this.graph=e.graph,this.seq=e.seq,this.show=e.show,this.status="begin",this.select=!1,this.time=i.getTimeStamp(),this.color=e.color,this.thin=e.thin,this.solid=e.solid||!1,this.startPoint={x:e.beginPoint.x,y:e.beginPoint.y,seq:e.beginPoint.seq},this.endPoint={x:e.endPoint.x,y:e.endPoint.y,seq:e.endPoint.seq}}},function(t,e,r){"use strict";var i=r(0);function o(t,e){this.user=t,this.type="line",this.seq=e.belongSeq,this.belongSeq=e.belongSeq,this.show=e.show,this.status="begin",this.select=!1,this.color=e.color,this.time=i.getTimeStamp(),this.thin=e.thin,this.startSeq=e.belongSeq,this.endSeq=0,this.lines=[{x:e.x,y:e.y,belongSeq:e.belongSeq,seq:e.seq}],this.border={maxX:e.x,maxY:e.y,minX:e.x,minY:e.y}}o.prototype.setBorder=function(t,e){t+this.thin>this.border.maxX&&(this.border.maxX=i.getEffectivePoint(t+this.thin,this.thin)),t-this.thin<this.border.minX&&(this.border.minX=i.getEffectivePoint(t-this.thin,this.thin)),e+this.thin>this.border.maxY&&(this.border.maxY=i.getEffectivePoint(e+this.thin,this.thin)),e-this.thin<this.border.minY&&(this.border.minY=i.getEffectivePoint(e-this.thin,this.thin))},o.prototype.sort=function(){this.lines.sort(function(t,e){return t.seq-e.seq})},t.exports=o},function(t,e,r){"use strict";t.exports=function(t,e){this.user=t,this.type=e.type,this.seq=e.seq}},function(t,e,r){"use strict";t.exports=function(t,e){this.user=t,this.type="raser",this.seq=e.seq,this.show=!0,this.status=1,this.color=e.color,this.radius=e.radius,this.location={x:e.x,y:e.y}}},function(t,e,r){"use strict";t.exports=function(t,e){this.user=t,this.type="select",this.seq=Math.floor(100*Math.random()),this.show=!0,this.color=e.color,this.startInfo={x:e.startx,y:e.starty},this.location={x:e.x,y:e.y}}},,function(t,e){t.exports=i;var r=null;try{r=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}function i(t,e,r){this.low=0|t,this.high=0|e,this.unsigned=!!r}function o(t){return!0===(t&&t.__isLong__)}i.prototype.__isLong__,Object.defineProperty(i.prototype,"__isLong__",{value:!0}),i.isLong=o;var n={},s={};function a(t,e){var r,i,o;return e?(o=0<=(t>>>=0)&&t<256)&&(i=s[t])?i:(r=d(t,(0|t)<0?-1:0,!0),o&&(s[t]=r),r):(o=-128<=(t|=0)&&t<128)&&(i=n[t])?i:(r=d(t,t<0?-1:0,!1),o&&(n[t]=r),r)}function l(t,e){if(isNaN(t))return e?y:m;if(e){if(t<0)return y;if(t>=f)return D}else{if(t<=-g)return S;if(t+1>=g)return T}return t<0?l(-t,e).neg():d(t%p|0,t/p|0,e)}function d(t,e,r){return new i(t,e,r)}i.fromInt=a,i.fromNumber=l,i.fromBits=d;var c=Math.pow;function u(t,e,r){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return m;if("number"==typeof e?(r=e,e=!1):e=!!e,(r=r||10)<2||36<r)throw RangeError("radix");var i;if((i=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===i)return u(t.substring(1),e,r).neg();for(var o=l(c(r,8)),n=m,s=0;s<t.length;s+=8){var a=Math.min(8,t.length-s),d=parseInt(t.substring(s,s+a),r);if(a<8){var h=l(c(r,a));n=n.mul(h).add(l(d))}else n=(n=n.mul(o)).add(l(d))}return n.unsigned=e,n}function h(t,e){return"number"==typeof t?l(t,e):"string"==typeof t?u(t,e):d(t.low,t.high,"boolean"==typeof e?e:t.unsigned)}i.fromString=u,i.fromValue=h;var p=4294967296,f=p*p,g=f/2,_=a(1<<24),m=a(0);i.ZERO=m;var y=a(0,!0);i.UZERO=y;var b=a(1);i.ONE=b;var E=a(1,!0);i.UONE=E;var v=a(-1);i.NEG_ONE=v;var T=d(-1,2147483647,!1);i.MAX_VALUE=T;var D=d(-1,-1,!0);i.MAX_UNSIGNED_VALUE=D;var S=d(0,-2147483648,!1);i.MIN_VALUE=S;var A=i.prototype;A.toInt=function(){return this.unsigned?this.low>>>0:this.low},A.toNumber=function(){return this.unsigned?(this.high>>>0)*p+(this.low>>>0):this.high*p+(this.low>>>0)},A.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(S)){var e=l(t),r=this.div(e),i=r.mul(e).sub(this);return r.toString(t)+i.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var o=l(c(t,6),this.unsigned),n=this,s="";;){var a=n.div(o),d=(n.sub(a.mul(o)).toInt()>>>0).toString(t);if((n=a).isZero())return d+s;for(;d.length<6;)d="0"+d;s=""+d+s}},A.getHighBits=function(){return this.high},A.getHighBitsUnsigned=function(){return this.high>>>0},A.getLowBits=function(){return this.low},A.getLowBitsUnsigned=function(){return this.low>>>0},A.getNumBitsAbs=function(){if(this.isNegative())return this.eq(S)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&0==(t&1<<e);e--);return 0!=this.high?e+33:e+1},A.isZero=function(){return 0===this.high&&0===this.low},A.eqz=A.isZero,A.isNegative=function(){return!this.unsigned&&this.high<0},A.isPositive=function(){return this.unsigned||this.high>=0},A.isOdd=function(){return 1==(1&this.low)},A.isEven=function(){return 0==(1&this.low)},A.equals=function(t){return o(t)||(t=h(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&(this.high===t.high&&this.low===t.low)},A.eq=A.equals,A.notEquals=function(t){return!this.eq(t)},A.neq=A.notEquals,A.ne=A.notEquals,A.lessThan=function(t){return this.comp(t)<0},A.lt=A.lessThan,A.lessThanOrEqual=function(t){return this.comp(t)<=0},A.lte=A.lessThanOrEqual,A.le=A.lessThanOrEqual,A.greaterThan=function(t){return this.comp(t)>0},A.gt=A.greaterThan,A.greaterThanOrEqual=function(t){return this.comp(t)>=0},A.gte=A.greaterThanOrEqual,A.ge=A.greaterThanOrEqual,A.compare=function(t){if(o(t)||(t=h(t)),this.eq(t))return 0;var e=this.isNegative(),r=t.isNegative();return e&&!r?-1:!e&&r?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},A.comp=A.compare,A.negate=function(){return!this.unsigned&&this.eq(S)?S:this.not().add(b)},A.neg=A.negate,A.add=function(t){o(t)||(t=h(t));var e=this.high>>>16,r=65535&this.high,i=this.low>>>16,n=65535&this.low,s=t.high>>>16,a=65535&t.high,l=t.low>>>16,c=0,u=0,p=0,f=0;return p+=(f+=n+(65535&t.low))>>>16,u+=(p+=i+l)>>>16,c+=(u+=r+a)>>>16,c+=e+s,d((p&=65535)<<16|(f&=65535),(c&=65535)<<16|(u&=65535),this.unsigned)},A.subtract=function(t){return o(t)||(t=h(t)),this.add(t.neg())},A.sub=A.subtract,A.multiply=function(t){if(this.isZero())return m;if(o(t)||(t=h(t)),r)return d(r.mul(this.low,this.high,t.low,t.high),r.get_high(),this.unsigned);if(t.isZero())return m;if(this.eq(S))return t.isOdd()?S:m;if(t.eq(S))return this.isOdd()?S:m;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(_)&&t.lt(_))return l(this.toNumber()*t.toNumber(),this.unsigned);var e=this.high>>>16,i=65535&this.high,n=this.low>>>16,s=65535&this.low,a=t.high>>>16,c=65535&t.high,u=t.low>>>16,p=65535&t.low,f=0,g=0,y=0,b=0;return y+=(b+=s*p)>>>16,g+=(y+=n*p)>>>16,y&=65535,g+=(y+=s*u)>>>16,f+=(g+=i*p)>>>16,g&=65535,f+=(g+=n*u)>>>16,g&=65535,f+=(g+=s*c)>>>16,f+=e*p+i*u+n*c+s*a,d((y&=65535)<<16|(b&=65535),(f&=65535)<<16|(g&=65535),this.unsigned)},A.mul=A.multiply,A.divide=function(t){if(o(t)||(t=h(t)),t.isZero())throw Error("division by zero");var e,i,n;if(r)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?d((this.unsigned?r.div_u:r.div_s)(this.low,this.high,t.low,t.high),r.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?y:m;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return y;if(t.gt(this.shru(1)))return E;n=y}else{if(this.eq(S))return t.eq(b)||t.eq(v)?S:t.eq(S)?b:(e=this.shr(1).div(t).shl(1)).eq(m)?t.isNegative()?b:v:(i=this.sub(t.mul(e)),n=e.add(i.div(t)));else if(t.eq(S))return this.unsigned?y:m;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();n=m}for(i=this;i.gte(t);){e=Math.max(1,Math.floor(i.toNumber()/t.toNumber()));for(var s=Math.ceil(Math.log(e)/Math.LN2),a=s<=48?1:c(2,s-48),u=l(e),p=u.mul(t);p.isNegative()||p.gt(i);)p=(u=l(e-=a,this.unsigned)).mul(t);u.isZero()&&(u=b),n=n.add(u),i=i.sub(p)}return n},A.div=A.divide,A.modulo=function(t){return o(t)||(t=h(t)),r?d((this.unsigned?r.rem_u:r.rem_s)(this.low,this.high,t.low,t.high),r.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},A.mod=A.modulo,A.rem=A.modulo,A.not=function(){return d(~this.low,~this.high,this.unsigned)},A.and=function(t){return o(t)||(t=h(t)),d(this.low&t.low,this.high&t.high,this.unsigned)},A.or=function(t){return o(t)||(t=h(t)),d(this.low|t.low,this.high|t.high,this.unsigned)},A.xor=function(t){return o(t)||(t=h(t)),d(this.low^t.low,this.high^t.high,this.unsigned)},A.shiftLeft=function(t){return o(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?d(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):d(0,this.low<<t-32,this.unsigned)},A.shl=A.shiftLeft,A.shiftRight=function(t){return o(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?d(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):d(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},A.shr=A.shiftRight,A.shiftRightUnsigned=function(t){if(o(t)&&(t=t.toInt()),0===(t&=63))return this;var e=this.high;return t<32?d(this.low>>>t|e<<32-t,e>>>t,this.unsigned):d(32===t?e:e>>>t-32,0,this.unsigned)},A.shru=A.shiftRightUnsigned,A.shr_u=A.shiftRightUnsigned,A.toSigned=function(){return this.unsigned?d(this.low,this.high,!1):this},A.toUnsigned=function(){return this.unsigned?this:d(this.low,this.high,!0)},A.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},A.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},A.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},i.fromBytes=function(t,e,r){return r?i.fromBytesLE(t,e):i.fromBytesBE(t,e)},i.fromBytesLE=function(t,e){return new i(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},i.fromBytesBE=function(t,e){return new i(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)}},function(t,e,r){"use strict";var i=r(1),o=r(4);function n(t){if(this.permissions=!1,this.option=Object.assign({},t),!this.option.tlsData)throw new Error("not found tlsData.sdkAppId|tlsData.identifie|tlsData.userSig");if(!this.option.tlsData.sdkAppId)throw new Error("not found tlsData.sdkAppId");if(!this.option.tlsData.identifier)throw new Error("not found tlsData.identifie");if(!this.option.tlsData.userSig)throw new Error("not found tlsData.userSig");this.BOARD_URL=(t.debug?i.TEST_SERVER_URL:i.SERVER_URL)+this.option.tlsData.sdkAppId,this.COS_SERVER_URL=t.debug?i.TEST_COS_SERVER_URL:i.COS_SERVER_URL,this.WHITELIST_SERVER_URL=(t.debug?i.TEST_WHITELIST_SERVER_URL:i.WHITELIST_SERVER_URL)+this.option.tlsData.sdkAppId}n.prototype.setPermissions=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.permissions=t},n.prototype.initXmlHttp=function(){return XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},n.prototype.reportMsg=function(t,e,r){this.option.conf_id&&this.permissions&&(t={cmd:"open_conf_svc",sub_cmd:"report_board_data",conf_id:parseInt(this.option.conf_id,10),board_data_list:t},this.post(t,e,r))},n.prototype.getBoardData=function(t,e){var r={cmd:"open_conf_svc",sub_cmd:"get_board_data",conf_id:parseInt(this.option.conf_id,10)};this.post(r,t,e)},n.prototype.getLineData=function(t,e,r){var i=(new Date).getTime(),n={cmd:"open_conf_svc",sub_cmd:"get_line",conf_id:parseInt(this.option.conf_id,10),boardId:t.boardId,owner:t.owner,seq:t.seq};this.post(n,function(t){o.report("getLineData",{action_result:0,time_consume:(new Date).getTime()-i,extra_info:JSON.stringify(t)}),e&&e(t)},function(t){o.report("getLineData",{action_result:-1,time_consume:(new Date).getTime()-i,extra_info:JSON.stringify(t)}),r&&r(t)})},n.prototype.getDocTotalPage=function(t){return axios.get(t)},n.prototype.getCosAuthData=function(){var t=this.COS_SERVER_URL+"?SdkAppId="+this.option.tlsData.sdkAppId+"&Identifier="+this.option.tlsData.identifier+"&UserSig="+this.option.tlsData.identifier;return axios.post(t,{cmd:"open_cos_svc",sub_cmd:"get_cos_token",duration:300,version:1})},n.prototype.applyPermissions=function(){var t=this.WHITELIST_SERVER_URL+"&usersig="+this.option.tlsData.userSig+"&identifier="+this.option.tlsData.identifier;return axios.post(t,{cmd:"open_conf_svc",sub_cmd:"verify_sdk",sdkappid:1*this.option.tlsData.sdkAppId})},n.prototype.post=function(t,e,r){var i=this.BOARD_URL+"&usersig="+this.option.tlsData.userSig+"&identifier="+this.option.tlsData.identifier;"undefined"==typeof axios?this.cPost(i,t,e,r):this.axiosPost(i,t,e,r)},n.prototype.axiosPost=function(t,e,r,i){axios.post(t,e).then(function(t){console.log(t.data),r&&r(t.data)}).catch(function(t){i&&i(t)})},n.prototype.cPost=function(t,e,r,i){var o=this.initXmlHttp();o.open("POST",t,!0),o.setRequestHeader("Content-Type","application/json;charset=UTF-8"),o.send(JSON.stringify(e)),o.onreadystatechange=function(){if(4==o.readyState)if(o.status>=200&&o.status<300||304==o.status){var t=null;try{t=JSON.parse(o.responseText),console.log("data:",e,"  ret:",t),r&&r(t)}catch(t){i&&i(t)}}else{var n=new Error("Network Error");i&&i(n)}}},t.exports=n},function(t,e,r){"use strict";r(8),r(7),r(6),r(10),r(9),r(5);var i=r(17),o=(r(1),r(3)),n=r(2),s=r(0),a=r(4);function l(t){if(!(this instanceof l))return new l(t);this.option=Object.assign({},t),this.container=document.getElementById(this.option.id),this.container?(this.conf_id=this.option.conf_id,this.canDraw=!1!==t.canDraw&&0!==t.canDraw,this.isMoving=!1,this.needDraw=!1,this.store=new i(t),this.store.setDefaultBoard(),this.init()):console.error("not found element")}l.prototype.resize=function(){this.layout(),this.draw(),a.report("resize",{extra_info:JSON.stringify({width:this.width,height:this.height})})},l.prototype.getEventLocation=function(t){var e={x:0,y:0};return t.offsetX?(e.x=t.offsetX,e.y=t.offsetY):(e.x=t.pageX-this.container.offsetLeft,e.y=t.pageY-this.container.offsetTop),e.x=parseInt(e.x/this.width*1e4),e.y=parseInt(e.y/this.height*1e4),e},l.prototype.draw=function(){var t=this,e=t.el.getContext("2d");e.clearRect(0,0,t.width,t.height);this.store.getTransparent();var r=this.store.getCurrentBoardData(),i=r.backgroundPic;if(i.url&&i.show)if(i.url!==t.img.src&&encodeURI(i.url)!==t.img.src&&decodeURI(i.url)!==decodeURI(t.img.src)){var l=(new Date).getTime();t.img.style.display="none",t.img.onload=function(){var e=t.img.naturalWidth,r=t.img.naturalHeight;t.width/t.height>e/r?(t.img.setAttribute("height",t.height),t.img.setAttribute("style","display:none; position:absolute; top:0; left:50%;transform: translateX(-50%);z-index:5;"),t.img.removeAttribute("width")):(t.img.setAttribute("width",t.width),t.img.setAttribute("style","display:none; position:absolute; top:50%; left:0;transform: translateY(-50%);z-index:5;"),t.img.removeAttribute("height")),t.img.style.display="block",t.img.onload=null,n.fire(this,o.EVENT.IMG_LOAD,{currentBoardId:t.getCurrentBoard(),imgUrl:i.url,currentImgUrl:t.img.currentSrc}),a.report("load_succ_img",{time_consume:Date.now()-l,image_url:i.url,boardid:t.getCurrentBoard(),extra_info:JSON.stringify({image_url:i.url,boardid:t.getCurrentBoard(),currentSrc:t.img.currentSrc})})},t.img.onabort=function(){t.img.onabort=null,n.fire(this,o.EVENT.IMG_ABORT,{currentBoardId:t.getCurrentBoard(),imgUrl:i.url,currentImgUrl:t.img.currentSrc}),a.report("load_abort_img",{time_consume:Date.now()-l,image_url:i.url,boardid:t.getCurrentBoard(),extra_info:JSON.stringify({image_url:i.url,boardid:t.getCurrentBoard(),currentSrc:t.img.currentSrc})})},t.img.onerror=function(){if(t.img.currentSrc.endsWith("&try=1"))t.img.onerror=null,console.error(">>> 图片加载失败：",i.url),n.fire(this,o.EVENT.IMG_ERROR,{currentBoardId:t.getCurrentBoard(),imgUrl:i.url,currentImgUrl:t.img.currentSrc}),a.report("load_error_img",{time_consume:Date.now()-l,image_url:i.url,boardid:t.getCurrentBoard(),extra_info:JSON.stringify({image_url:i.url,boardid:t.getCurrentBoard(),currentSrc:t.img.currentSrc})});else{console.error(">>> 图片重新加载：",i.url);var e=i.url+"&try=1";t.img.src=e,a.report("load_try_img",{time_consume:Date.now()-l,image_url:e,boardid:t.getCurrentBoard(),extra_info:JSON.stringify({image_url:e,boardid:t.getCurrentBoard(),currentSrc:t.img.currentSrc})})}},n.fire(this,o.EVENT.IMG_START_LOAD,{currentBoardId:t.getCurrentBoard(),imgUrl:i.url,currentImgUrl:t.img.currentSrc}),a.report("start_load_img",{image_url:i.url,boardid:t.getCurrentBoard(),extra_info:JSON.stringify({image_url:i.url,boardid:t.getCurrentBoard(),currentSrc:t.img.currentSrc})}),t.img.src=i.url}else{var d=t.img.naturalWidth,c=t.img.naturalHeight;t.width/t.height>d/c?(t.img.setAttribute("height",t.height),t.img.setAttribute("style","display:none; position:absolute; top:0; left:50%;transform: translateX(-50%);z-index:5;"),t.img.removeAttribute("width")):(t.img.setAttribute("width",t.width),t.img.setAttribute("style","display:none; position:absolute; top:50%; left:0;transform: translateY(-50%);z-index:5;"),t.img.removeAttribute("height")),t.img.style.display="block"}else t.img.removeAttribute("src"),t.img.removeAttribute("width"),t.img.removeAttribute("height");r.backgroundColor?this.bgDiv.setAttribute("style","z-index:4;position:absolute; top:0; left:0;background-color:"+r.backgroundColor+";width:"+this.width+"px;height:"+this.height+"px;"):this.bgDiv.setAttribute("style","z-index:4;position:absolute; top:0; left:0;"),function(){var i=r.data;if((i=i.sort(function(t,e){return t.seq-e.seq})).forEach(function(r){if("line"==r.type&&r.show)t.drawLine(e,r.lines,r.color,r.thin);else if("raser"==r.type&&r.status)e.beginPath(),e.arc(r.location.x/1e4*t.width,r.location.y/1e4*t.height,r.radius/1e4*t.height,0,2*Math.PI),e.fillStyle=s.dealColor(o.COLOR.RED),e.fill(),e.closePath();else if("select"==r.type&&r.show)e.setLineDash([15,5]),e.lineWidth=1,e.strokeStyle=t.store.color,e.strokeRect(r.startInfo.x/1e4*t.width,r.startInfo.y/1e4*t.height,(r.location.x-r.startInfo.x)/1e4*t.width,(r.location.y-r.startInfo.y)/1e4*t.height),e.setLineDash([]);else if("graph"==r.type&&r.show)if("line"==r.graph)e.beginPath(),e.moveTo(r.startPoint.x/1e4*t.width,r.startPoint.y/1e4*t.height),e.lineTo(r.endPoint.x/1e4*t.width,r.endPoint.y/1e4*t.height),e.strokeStyle=r.color,e.lineWidth=r.thin/1e4*t.height,e.lineCap="round",e.stroke();else if("rect"==r.graph){var i=r.startPoint.x>r.endPoint.x?r.endPoint.x:r.startPoint.x,n=r.startPoint.y>r.endPoint.y?r.endPoint.y:r.startPoint.y;e.strokeStyle=r.color,e.lineWidth=r.thin/1e4*t.height,r.solid?(e.fillStyle=r.color,e.fillRect(i/1e4*t.width,n/1e4*t.height,Math.abs(r.startPoint.x-r.endPoint.x)/1e4*t.width,Math.abs(r.startPoint.y-r.endPoint.y)/1e4*t.height)):e.strokeRect(i/1e4*t.width,n/1e4*t.height,Math.abs(r.startPoint.x-r.endPoint.x)/1e4*t.width,Math.abs(r.startPoint.y-r.endPoint.y)/1e4*t.height)}else if("circle"==r.graph||"oval"==r.graph){i=(r.startPoint.x+r.endPoint.x)/2/1e4*t.width,n=(r.startPoint.y+r.endPoint.y)/2/1e4*t.height;var a=Math.abs(r.startPoint.x-r.endPoint.x)/2/1e4*t.width,l=Math.abs(r.startPoint.y-r.endPoint.y)/2/1e4*t.height;e.strokeStyle=r.color,e.lineWidth=r.thin/1e4*t.height,function(t,e,r,i,o,n,s){var a=.5522848,l=i*a,d=o*a;t.beginPath(),t.moveTo(e-i,r),t.bezierCurveTo(e-i,r-d,e-l,r-o,e,r-o),t.bezierCurveTo(e+l,r-o,e+i,r-d,e+i,r),t.bezierCurveTo(e+i,r+d,e+l,r+o,e,r+o),t.bezierCurveTo(e-l,r+o,e-i,r+d,e-i,r),t.closePath(),t.stroke(),n&&(t.fillStyle=s,t.fill())}(e,i,n,a,l,r.solid,r.color),e.stroke()}}),t.isMoving){var n=t.store.getSelectArea(),a=t.store.getThin();e.setLineDash([15,5]),e.lineWidth=1,e.strokeRect((n.x-a)/1e4*t.width,(n.y-a)/1e4*t.height,(n.width+2*a)/1e4*t.width,(n.height+2*a)/1e4*t.height),e.setLineDash([])}else{var l=this.store.getSelectList();l.forEach(function(r){if("line"==r.type)e.setLineDash([15,5]),e.lineWidth=1,e.strokeRect((r.border.minX-2*r.thin)/1e4*t.width,(r.border.minY-2*r.thin)/1e4*t.height,(r.border.maxX-r.border.minX+4*r.thin)/1e4*t.width,(r.border.maxY-r.border.minY+4*r.thin)/1e4*t.height),e.setLineDash([]);else if("graph"==r.type){var i=r.endPoint.x,o=r.endPoint.y,n=r.startPoint.x,s=r.startPoint.y;e.setLineDash([15,5]),e.lineWidth=1,e.strokeRect((n-2*r.thin)/1e4*t.width,(s-2*r.thin)/1e4*t.height,(i-n+4*r.thin)/1e4*t.width,(o-s+4*r.thin)/1e4*t.height),e.setLineDash([])}})}}.apply(this)},l.prototype.addBoard=function(){var t=this.store.createBoardId();this.store.addBoard(t)},l.prototype.getBoardData=function(){return JSON.parse(JSON.stringify(this.store.getData()))},l.prototype.addHistory=function(t){this.store.addHistory(t)},l.prototype.addData=function(t){this.store.addData(t)},l.prototype.deleteBoard=function(t){this.store.deleteBoard(t)},l.prototype.getBoardList=function(){return JSON.parse(JSON.stringify(this.store.getBoardList()))},l.prototype.getBoardPicList=function(){return JSON.parse(JSON.stringify(this.store.getBoardPicList()))},l.prototype.getCurrentBoard=function(){return this.store.currentBoard},l.prototype.getCurrentFile=function(){return this.store.getCurrentFile()},l.prototype.switchBoard=function(t){return this.store.switchBoard(t)},l.prototype.prevBoard=function(){var t=this.getBoardList(),e=this.getCurrentBoard(),r=t.indexOf(e);r<1||this.switchBoard(t[r-1])},l.prototype.nextBoard=function(){var t=this.getBoardList(),e=this.getCurrentBoard(),r=t.indexOf(e);r<t.length-1&&this.switchBoard(t[r+1])},l.prototype.setGlobalBackgroundColor=function(t){this.store.setGlobalBackgroundColor(t)},l.prototype.setBackgroundColor=function(t){this.store.setBackgroundColor(t)},l.prototype.init=function(){var t=this;a.report("init");var e,r=null;window.onresize=function(){clearTimeout(r),r=setTimeout(function(){t.resize()},200)},l.prototype.renderCanvas=function(){var t=this;if(this.container.innerHTML='<div class="tx_board_canvas_wrap" style="position: relative;"><canvas style="z-index:10;position:absolute; top:0; left:0;"></canvas>                                <img style="display:none; position:absolute; top:0; left:0;z-index:5;" />                                <div class="tic_board_bg" style="z-index:4;position:absolute; top:0; left:0;"></div></div>',this.canvasWrap=this.container.getElementsByClassName("tx_board_canvas_wrap")[0],this.el=this.container.getElementsByTagName("canvas")[0],this.img=this.container.getElementsByTagName("img")[0],this.bgDiv=this.container.getElementsByClassName("tic_board_bg")[0],this.draw(),this.el.addEventListener("mousedown",function(r){(function(t){f(t),this.canDraw&&(p=!0,i=!0,this.store.resetOperation(),u=d=this.getEventLocation(t).x,h=c=this.getEventLocation(t).y,e=this.store.getType(),this.store.getColor(),this.store.getThin(),"line"==e?(this.store.cancelSelect(),this.store.collectLineData().start(d,c)):"eraser"==e?(this.store.cancelSelect(),this.store.collectEraserData(d,c)):"raser"==e?(this.store.cancelSelect(),this.store.collectRaserData().start(d,c)):"select"==e?(this.store.cancelSelect(),this.store.collectSelectData().start(d,c)):"pointselect"==e?this.store.cancelSelect():"move"==e?this.store.collectMoverData().beforeStart(d,c)&&(this.isMoving=!0,this.store.collectMoverData().start(d,c)):e.indexOf("graph")>-1&&(this.store.cancelSelect(),this.store.collectGraphData().start(d,c)))}).apply(t,[r]),n.fire(t,o.EVENT.CANVAS_MOUSEDOWN,r)},!1),this.el.addEventListener("mousemove",function(r){(function(t){if(f(t),this.canDraw&&(e=this.store.getType(),this.store.getColor(),this.store.getThin(),"eraser"!=e&&i)){var r=this.getEventLocation(t).x,o=this.getEventLocation(t).y;if("line"==e){var n=this.option.tlsData.identifier,s=this.store.getCurrentBoard(),a=this.store.userData[s][n].length;this.store.userData[s][n][a-1],this.store.setNeedDraw(!0),this.store.collectLineData().draw(r,o)}else"raser"==e?this.store.collectRaserData().draw(r,o):"select"==e?this.store.collectSelectData().draw(r,o):"pointselect"==e||("move"==e?this.store.collectMoverData().draw(r,o,u,h):e.indexOf("graph")>-1&&this.store.collectGraphData().draw(r,o));u=r,h=o}}).apply(t,[r]),n.fire(t,o.EVENT.CANVAS_MOUSEMOVE,r)},!0),this.el.addEventListener("mouseup",function(r){(function(t){if(f(t),this.canDraw){i=!1,e=this.store.getType();var r=this.getEventLocation(t).x,o=this.getEventLocation(t).y;if("line"==e){if(!p)return;this.store.collectLineData().end(r,o)}else{if("eraser"==e)return;"raser"==e?this.store.collectRaserData().end(r,o):"select"==e?this.store.collectSelectData().end(d,c,r,o):"pointselect"==e?this.store.collectPointSelectData(r,o):"move"==e?(this.isMoving=!1,this.store.collectMoverData().end()):e.indexOf("graph")>-1&&this.store.collectGraphData().end(r,o)}}}).apply(t,[r]),n.fire(t,o.EVENT.CANVAS_MOUSEUP,r)},!1),this.el.addEventListener("mouseleave",function(e){(function(t){if(f(t),this.canDraw){var e=this.store.getType(),r=this.getEventLocation(t).x,o=this.getEventLocation(t).y;if(p=!1,1==i){if("line"==e){var n=this.store.getThin();r=s.getEffectivePoint(r,n),o=s.getEffectivePoint(o,n),this.store.collectLineData().over(r,o)}else if("raser"==e)this.store.collectRaserData().over();else if("select"==e)this.store.collectSelectData().end(d,c,r,o);else if(e.indexOf("graph")>-1){var n=this.store.getThin();r=s.getEffectivePoint(r,n),o=s.getEffectivePoint(o,n),this.store.collectGraphData().over(r,o)}i=!1}}}).apply(t,[e]),n.fire(t,o.EVENT.CANVAS_MOUSELEAVE,e)},!1),this.option.event)for(var r=0;r<this.option.event.length;r++){var a=this.option.event[r];console.log(a),this.el.addEventListener(a.type,a.fn,!1)}},this.renderCanvas(),this.layout(),this.drawInterval=setInterval(function(){t.store.getNeedDraw()&&(t.draw(),t.store.setNeedDraw(!1))},50);var i=!1,d=-10,c=-10,u=-10,h=-10,p=!1;this.el.getContext("2d");function f(t){t.preventDefault?t.preventDefault():t.returnValue=!1}},l.prototype.setColor=function(t){this.store.setColor(t)},l.prototype.setThin=function(t){this.store.setThin(t)},l.prototype.setRadius=function(t){this.store.setRadius(t)},l.prototype.setType=function(t){this.store.setType(t)},l.prototype.undo=function(){this.store.undo()},l.prototype.canUndo=function(){return this.store.canUndo()},l.prototype.redo=function(){this.store.redo()},l.prototype.canRedo=function(){return this.store.canRedo()},l.prototype.clearBoard=function(t){this.store.clearBoard(t)},l.prototype.clear=function(){this.store.clear()},l.prototype.clearDraws=function(){this.store.clearDraws()},l.prototype.clearAll=function(){this.store.clearAll()},l.prototype.addBackgroundPic=function(t,e,r){this.store.addBackgroundPic(t,e,r)},l.prototype.setBackgroundPic=function(t){this.store.setBackgroundPic(t)},l.prototype.deleteBackgroundPic=function(t){this.store.deleteBackgroundPic(t)},l.prototype.cancelBackgroundPic=function(){this.store.cancelBackgroundPic()},l.prototype.clearGlobalBgColor=function(){this.store.clearGlobalBgColor()},l.prototype.cancelSelect=function(){this.store.cancelSelect()},l.prototype.setCanDraw=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.canDraw=t},l.prototype.addFile=function(t,e){return this.store.addFile(t,e)},l.prototype.deleteFile=function(t){return this.store.deleteFile(t)},l.prototype.switchFile=function(t){return this.store.switchFile(t)},l.prototype.getGroup=function(){return this.store.getGroup()},l.prototype.getBoardByGroup=function(t){return this.store.getBoardByGroup(t)},l.prototype.clearFileDraws=function(t){return this.store.clearFileDraws(t)},l.prototype.layout=function(){var t=this.container.clientWidth,e=this.container.clientHeight,r=this.option.aspect,i=16,o=9;if(!1===r)this.width=t,this.height=e;else{if(void 0===r)i=16,o=9;else try{var n=r.split(":");i=1*n[0],i=isNaN(i)?16:i,o=1*n[1],o=isNaN(o)?9:o}catch(t){i=16,o=9}t/e>i/o?(this.width=e*i/o,this.height=e):(this.width=t,this.height=t*o/i)}var s="position:relative;left: 50%;top: 50%;transform: translateX(-50%) translateY(-50%);width:"+this.width+"px;height:"+this.height+"px";this.canvasWrap&&this.canvasWrap.setAttribute("style",s),this.el&&this.el.setAttribute("width",this.width),this.el&&this.el.setAttribute("height",this.height),this.img&&this.img.setAttribute("width",this.width),this.img&&this.img.setAttribute("height",this.height),this.bgDiv&&this.bgDiv.setAttribute("width",this.width),this.bgDiv&&this.bgDiv.setAttribute("height",this.height),this.store.setBoardSize(this.width,this.height)},l.prototype.drawLine=function(t,e,r,i){if(t.lineWidth=i/1e4*this.height,t.lineCap="round",t.strokeStyle=r,t.fillStyle=r,e.length<3){var o=e[0];return t.beginPath(),t.arc(o.x/1e4*this.width,o.y/1e4*this.height,t.lineWidth/2,0,2*Math.PI,!0),t.fill(),void t.closePath()}t.beginPath(),t.moveTo(e[0].x/1e4*this.width,e[0].y/1e4*this.height);for(var n=1;n<e.length-2;n++){var s=(e[n].x/1e4*this.width+e[n+1].x/1e4*this.width)/2,a=(e[n].y/1e4*this.height+e[n+1].y/1e4*this.height)/2;t.quadraticCurveTo(e[n].x/1e4*this.width,e[n].y/1e4*this.height,s,a)}t.quadraticCurveTo(e[n].x/1e4*this.width,e[n].y/1e4*this.height,e[n+1].x/1e4*this.width,e[n+1].y/1e4*this.height),t.stroke()},t.exports=l},function(t,e,r){"use strict";var i=r(3),o=r(2),n=r(13),s=r(4),a=r(24);function l(t){this.cos=null,this.options=t,this.options.cosData=t.cosData||{},this.options.cosData.appid=t.cosData.appid||1257240443,this.options.cosData.bucket=t.cosData.bucket||this.genBucket(this.options.tlsData.sdkAppId),this.options.cosData.region=t.cosData.region||"ap-shanghai",this.options.cosData.path=t.cosData.path||"/TIC/WEB/",this.request=new n(t),this.init(this.options)}l.prototype.init=function(t){var e=this;COS&&(this.cos=new COS({getAuthorization:function(r,n){t.cosData.url?axios.get(t.cosData.url).then(function(t){var r=t.data;r.Authorization?(o.fire(e,i.EVENT.COS.GET_SIGN_SUCCESS,r),n({Authorization:r.Authorization,XCosSecurityToken:r.XCosSecurityToken})):r.TmpSecretId?(o.fire(e,i.EVENT.COS.GET_SIGN_SUCCESS,r),n({TmpSecretId:r.TmpSecretId,TmpSecretKey:r.TmpSecretKey,XCosSecurityToken:r.XCosSecurityToken,ExpiredTime:r.ExpiredTime})):o.fire(e,i.EVENT.COS.GET_SIGN_ERROR,r)}).catch(function(t){o.fire(e,i.EVENT.COS.GET_SIGN_ERROR,t)}):t.cosData.sign?n(t.cosData.sign):e.request.getCosAuthData().then(function(t){try{if(t&&t.data&&0==t.data.error_code){var r=t.data;o.fire(e,i.EVENT.COS.GET_SIGN_SUCCESS,t),n({TmpSecretId:r.tmp_secret_id,TmpSecretKey:r.tmp_secret_key,XCosSecurityToken:r.session_token,ExpiredTime:r.expired_time})}else o.fire(e,i.EVENT.COS.GET_SIGN_ERROR,t)}catch(t){o.fire(e,i.EVENT.COS.GET_SIGN_ERROR,t)}}).catch(function(t){o.fire(e,i.EVENT.COS.GET_SIGN_ERROR,t)})}}))},l.prototype.uploadFile=function(t,e,r){var i=this,o=this,n=Date.now();this.uploadCosFile(t).then(function(t){if(/\.(bmp|jpg|jpeg|png|gif|webp|svg|psd|ai)/i.test(t.Key))e&&e(t.Key.substring(t.Key.indexOf("_")+1),"https://"+t.Location);else{var a=Date.now(),l=0;!function i(){o.getDocTotalPage(t).then(function(d){if(200===d.status&&d.headers["user-returncode"]){var c=1*d.headers["user-returncode"],u=o.getFileUrl(t,c);e&&e(c,u),s.report("get_file_total_page",{time_consume:Date.now()-n,extra_info:JSON.stringify({extra_info:{totalPage:c,info:u}})})}else l++>3?r&&r(d):setTimeout(function(){i()},1e3),s.report("get_file_total_page",{action_result:1,action_info:JSON.stringify(d),time_consume:Date.now()-a,extra_info:JSON.stringify({retryCount:l})})}).catch(function(t){l++>3?r&&r(t):setTimeout(function(){i()},1e3),s.report("get_file_total_page",{action_result:1,action_info:JSON.stringify(t),time_consume:Date.now()-a,extra_info:JSON.stringify({retryCount:l})})})}()}s.report("cos_upload_file",{time_consume:Date.now()-n,extra_info:JSON.stringify({bucket:i.options.cosData.bucket,cos_appid:i.options.cosData.appid,region:i.options.cosData.region,data:t})})}).catch(function(t){r&&r(t),s.report("cos_upload_file",{action_result:1,action_info:JSON.stringify(t),time_consume:Date.now()-n,extra_info:JSON.stringify({bucket:i.options.cosData.bucket,cos_appid:i.options.cosData.appid,region:i.options.cosData.region})})})},l.prototype.uploadCosFile=function(t){var e=this;return new Promise(function(r,n){e.cos.sliceUploadFile({Bucket:e.options.cosData.bucket+"-"+e.options.cosData.appid,Region:e.options.cosData.region,Key:e.options.cosData.path+(new Date).getTime()+"_"+t.name,Body:t,TaskReady:function(t){o.fire(this,i.EVENT.COS.TASK_READY,t)},onHashProgress:function(t){o.fire(this,i.EVENT.COS.HASH_PROGRESS,t)},onProgress:function(t){o.fire(this,i.EVENT.COS.PROGRESS,t)}},function(t,s){s&&200===s.statusCode?(o.fire(e,i.EVENT.COS.UPLOAD_SUCCESS,s),r(s)):(o.fire(e,i.EVENT.COS.UPLOAD_ERROR,t),n(t))})})},l.prototype.getDocTotalPage=function(t){var e="https://"+this.options.cosData.bucket+"-"+this.options.cosData.appid+".preview.myqcloud.com/"+encodeURIComponent(t.Key)+"?cmd=doc_preview&of=pic&page=1";return this.request.getDocTotalPage(e)},l.prototype.getFileUrl=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=[],i=0;i<e;i++)r.push("https://"+this.options.cosData.bucket+"-"+this.options.cosData.appid+".preview.myqcloud.com/"+encodeURIComponent(t.Key)+"?cmd=doc_preview&of=pic&page="+(i+1));return{picUrls:r,fileName:t.Key.substring(t.Key.indexOf("_")+1),fileUrl:"https://"+t.Location}},l.prototype.getInstance=function(){return this.cos},l.prototype.genBucket=function(t){var e="edu-"+t;return a(e).substring(0,4)+"-"+e},t.exports=l},,function(t,e,r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=r(1),n=r(3),s=r(0),a=r(5),l=r(2),d=r(8),c=r(7),u=r(6),h=r(10),p=r(9),f=r(13),g=r(21),_=r(4);function m(t){this.options=JSON.parse(JSON.stringify(t)),this.maxSeq=0,this.request=new f(t),this.report=new g(this.request),this.permissions=0,this.applyPermissions(),this.syncHistroy=t.syncHistroy||!0,this.identifier=t.tlsData.identifier,this.conf_id=t.conf_id,this.user=t.tlsData.identifier,_.setSdkAppid(t.tlsData.sdkAppId),_.setRoomId(this.conf_id),_.setUserId(t.tlsData.identifier),this.data={},this.opData={},this.opIndex={},this.userData={},this.backgroundPic={},this.backgroundColor={},this.currentGroup=null,this.currentBoard=null,this.boardList=[],this.groups=[],this.color=0,this.thin=0,this.radius=0,this.globalBackgroundColor=0,this.type=null,this.transparent=!1,this.seq=0,this.selectedList=[],this.selectArea={},this.gSeq=0,this.boardIdSeq=0,this.belongLineSeq=0,this.realTimeData=[],this.beforeMoveType="",this.initInterval(),this.initData(t)}m.prototype.applyPermissions=function(){var t=this,e=Date.now();this.request.applyPermissions().then(function(r){try{0===r.data.error_code&&r.data.level?(t.permissions=r.data.level,t.request.setPermissions(t.permissions),t.syncHistroy&&t.conf_id&&t.syncHistroyData(),l.fire(t,n.EVENT.VERIFY_SDK_SUCC),_.report("verify_sdk",{time_consume:Date.now()-e,extra_info:JSON.stringify({permissions:t.permissions})})):(t.permissions=0,t.request.setPermissions(t.permissions),l.fire(t,n.EVENT.VERIFY_SDK_ERROR),_.report("verify_sdk",{action_result:r.data.error_code,action_info:JSON.stringify(r.data),time_consume:Date.now()-e,extra_info:JSON.stringify({permissions:t.permissions})}))}catch(r){t.permissions=0,t.request.setPermissions(t.permissions),l.fire(t,n.EVENT.VERIFY_SDK_ERROR),_.report("verify_sdk",{action_result:-2,action_info:JSON.stringify(r),time_consume:Date.now()-e,extra_info:JSON.stringify({permissions:t.permissions})})}t.needDraw=!0},function(r){t.permissions=0,t.request.setPermissions(t.permissions),l.fire(t,n.EVENT.VERIFY_SDK_ERROR),_.report("verify_sdk",{action_result:-1,action_info:JSON.stringify(r),time_consume:Date.now()-e,extra_info:JSON.stringify({permissions:t.permissions})}),t.needDraw=!0})},m.prototype.createBoardId=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentGroup;return 0==this.boardIdSeq?(this.boardIdSeq++,o.COMMON_DEFAULT_BOARD):o.PLATFORM+"_"+this.identifier+"_"+parseInt((new Date).getTime()/1e3)+"_"+this.boardIdSeq+++"_"+t},m.prototype.initInterval=function(){var t=this;this.sendInterval=setInterval(function(){t.realTimeData.length>0&&t.sendRequest()},200)},m.prototype.initData=function(t){this.setColor(t.color),this.setThin(t.thin),this.setRadius(t.radius),this.setType(t.type),this.setGlobalBackgroundColor(t.globalBackgroundColor,!0),this.setTransparent(t.transparent),this.setSelectArea()},m.prototype.addBoard=function(t){var e=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=[];if(Array.isArray(t))i=t;else{if(!t)return;i=[t]}return i.forEach(function(t,r){e.userData[t]={},e.userData[t][e.identifier]=[],e.data[t]=[],e.opData[t]=[],e.opIndex[t]=0,e.backgroundColor[t]=e.globalBackgroundColor,e.backgroundPic[t]={url:"",user:e.identifier,show:!0},-1===e.boardList.indexOf(t)&&e.boardList.push(t)}),setTimeout(function(){l.fire(e,n.EVENT.ADD_BOARD,{current:e.currentBoard,list:e.boardList})},100),r&&this.report.reportCreateBoards(this.currentBoard,i),this.boardList},m.prototype.findLine=function(t,e,r){for(var i,o=this.userData[t][e],n=0,s=o.length;n<s;n++){var a=o[n];if("line"===a.type&&a.seq==r.belongSeq){i=a;break}}return i},m.prototype.setNeedDraw=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.needDraw=t},m.prototype.getNeedDraw=function(){return this.needDraw},m.prototype.getBoardList=function(){return this.boardList},m.prototype.getBoardPicList=function(){return this.backgroundPic},m.prototype.setDefaultBoard=function(){this.currentGroup=o.COMMON_GROUP,this.addGroup(o.COMMON_GROUP,o.COMMON_GROUP),this.currentBoard=this.createBoardId(),this.addBoard(this.currentBoard),this.setBackgroundColor(s.formatColor(this.globalBackgroundColor),!0),delete this.setDefaultBoard},m.prototype.removeBoard=function(t){Array.isArray(t)||(t=[t]);for(var e=[],r=!1,i=0,s=t.length;i<s;i++){var a,d=t[i];if(d!==o.COMMON_DEFAULT_BOARD)(a=this.boardList.indexOf(d))>-1&&(e.push(d),delete this.userData[d],delete this.data[d],delete this.opData[d],delete this.opIndex[d],d==this.currentBoard?(this.boardList.splice(a,1),this.currentBoard=this.boardList[a]?this.boardList[a]:this.boardList[a-1],r=!0):this.boardList.splice(a,1));else console.log("默认白板页不能删除")}return e.length&&l.fire(this,n.EVENT.DELETE_BOARD,{current:this.currentBoard,list:this.boardList}),r&&l.fire(this,n.EVENT.SWITCH_BOARD,{current:this.currentBoard,list:this.boardList}),this.needDraw=!0,e},m.prototype.deleteBoard=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentBoard,e=arguments[1],r=this.removeBoard(t)||[];return r.length&&(this.realTimeData.push({action:o.PROTOCOL_ACTION.SWITCH_ACTION,time:s.getAVSdkTimestamp(),seq:a.getSeq(),toBoardId:this.currentBoard,deleteBoards:e?[]:r,deleteFiles:e?[e]:[]}),this.report.reportDeleteBoard(r,this.currentBoard)),r},m.prototype.getGroup=function(){return this.groups},m.prototype.getBoardByGroup=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.COMMON_GROUP;return this.boardList.filter(function(e){return t===o.COMMON_GROUP&&e===o.COMMON_DEFAULT_BOARD||e.indexOf("_"+t)>-1})},m.prototype.addGroup=function(t,e,r,i,s){for(var a=!1,d=0,c=this.groups.length;d<c;d++){var u=this.groups[d];if(u.fid==u){a=!0;break}}return a?this.groups:(l.fire(this,n.EVENT.ADD_FILE,t),t&&t!==o.COMMON_GROUP&&this.report.reportAddFile(t,e||t),this.groups.push({fid:t,title:e,downloadURL:r,pageCount:i,currentPageIndex:s}))},m.prototype.deleteGroup=function(t){if(t===o.COMMON_GROUP)return console.error("不允许删除默认的白板分组"),!1;for(var e=-1,r=0,i=this.groups.length;r<i;r++){if(this.groups[r].fid==t){e=r;break}}return-1==e?(console.error("删除的分组不存在"),!1):(this.groups.splice(e,1),this.report.reportDeleteFile(t),this.getBoardByGroup(t))},m.prototype.setColor=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.COLOR.RED;this.cancelSelect(),"number"==typeof t?this.color=s.dealColor(t):"string"!=typeof t||0!=t.indexOf("#")||4!==t.length&&7!==t.length||(this.color=s.hexToRgba(t))},m.prototype.getColor=function(){return this.color},m.prototype.setThin=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.THIN;this.cancelSelect(),this.thin=t},m.prototype.getThin=function(){return this.thin},m.prototype.setRadius=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.RADIUS;this.cancelSelect(),this.radius=t},m.prototype.setType=function(t){var e=Object.values(n.BOARD_ACTION_TYPE);"move"!=t&&this.cancelSelect(),e.indexOf(t)>-1?this.type=t:this.type=n.BOARD_ACTION_TYPE.LINE},m.prototype.getType=function(){return this.type},m.prototype.setTransparent=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.transparent=t},m.prototype.getTransparent=function(){return this.transparent},m.prototype.setBackgroundColor=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.COLOR.WHITE,e=arguments[1],r=this.currentBoard;"object"===(void 0===t?"undefined":i(t))&&(r=t.boardId,t=t.color);var l=0;"number"==typeof t?(this.backgroundColor[r]=s.dealColor(t),l=t):"string"!=typeof t||0!=t.indexOf("#")||4!==t.length&&7!==t.length||(this.backgroundColor[r]=s.hexToRgba(t),l=s.formatColor(s.hexToRgba(t))),this.needDraw=!0,e||(this.realTimeData.push({action:o.PROTOCOL_ACTION.UPDATE_BG_COLOR_ACTION,time:s.getAVSdkTimestamp(),seq:a.getSeq(),color:l,isGlobal:0}),this.report.reportSetBoardBgColor(r,l))},m.prototype.setSelectArea=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.selectArea={x:t,y:e,width:r,height:i}},m.prototype.getSelectArea=function(){return this.selectArea},m.prototype.getCurrentBoard=function(){return this.currentBoard},m.prototype.getCurrentFile=function(){return this.currentGroup},m.prototype.getData=function(){return this.data},m.prototype.getCurrentBoardData=function(){return{data:this.data[this.currentBoard],userData:this.userData[this.currentBoard],opData:this.opData[this.currentBoard],opIndex:this.opIndex[this.currentBoard],backgroundPic:this.backgroundPic[this.currentBoard],backgroundColor:this.backgroundColor[this.currentBoard]}},m.prototype.getCurrentBoardPic=function(){return this.backgroundPic[this.currentBoard]},m.prototype.getCurrentBoardColor=function(){return this.backgroundColor[this.currentBoard]},m.prototype.getSelectList=function(){return this.selectedList},m.prototype.clearBoard=function(t){this.currentBoard&&(this.data[this.currentBoard]=[],this.opData[this.currentBoard]=[],this.opIndex[this.currentBoard]=0,this.userData[this.currentBoard]={},this.userData[this.currentBoard][this.identifier]=[],t||(this.backgroundPic[this.currentBoard]={url:"",user:""},this.backgroundColor[this.currentBoard]=this.globalBackgroundColor),this.cancelSelect(),this.needDraw=!0)},m.prototype.clearFileDrawData=function(t){var e=this;t.forEach(function(t){(e.getBoardByGroup(t)||[]).forEach(function(t){e.data[t]=[],e.opData[t]=[],e.opIndex[t]=0,e.userData[t]={},e.userData[t][e.identifier]=[]})}),this.cancelSelect(),this.needDraw=!0},m.prototype.clear=function(){this.clearBoard(),this.realTimeData.push({action:101,seq:a.getSeq()}),this.report.reportClear(this.currentBoard)},m.prototype.clearDraws=function(){this.clearBoard(!0),this.realTimeData.push({action:102,seq:a.getSeq()}),this.report.reportClearDraws(this.currentBoard)},m.prototype.clearFileDraws=function(t){var e=this;if(t){Array.isArray(t)||(t=[t]),this.clearFileDrawData(t);var r=[];t.forEach(function(t){r=r.concat(e.getBoardByGroup(t))}),this.realTimeData.push({action:103,seq:a.getSeq(),fids:t}),this.report.reportClearDraws(r)}},m.prototype.clearAll=function(){this.report.reportCleanAll()},m.prototype.addBackgroundPic=function(t,e){var r=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=[],l=[];if(Array.isArray(t)){if(!Array.isArray(e)||t.length!=e.length)return!1;n=t,l=e}else{if(Array.isArray(e))return!1;n=[t],l=[e]}var d=[];this.cancelSelect(),n.forEach(function(t,e){t===r.currentBoard&&i&&r.realTimeData.push({action:o.PROTOCOL_ACTION.UPDATE_BG_IMG_ACTION,url:encodeURI(l[e]),time:s.getAVSdkTimestamp(),seq:a.getSeq(),mode:0,cleanBoard:0}),r.data[t]||r.addBoard(t),r.backgroundPic[t].url=l[e],r.backgroundPic[t].show=!0,d.push({type:"image",seq:a.getSeq(),content:{boardId:t,url:l[e],updateTime:s.getTimeStamp(),mode:0}})}),i&&this.report.reportImages(d)},m.prototype.setBackgroundPic=function(t){this.cancelSelect(),this.addBackgroundPic(this.currentBoard,t,!1),this.realTimeData.push({action:o.PROTOCOL_ACTION.UPDATE_BG_IMG_ACTION,url:t,time:s.getAVSdkTimestamp(),seq:a.getSeq(),mode:0,cleanBoard:0}),this.report.reportImage(this.currentBoard,t)},m.prototype.deleteBackgroundPic=function(t){this.cancelSelect(),this.backgroundPic[t].show=!1,this.needDraw=!0},m.prototype.cancelBackgroundPic=function(){this.cancelSelect(),this.deleteBackgroundPic(this.currentBoard),this.img.style.display="none",this.realTimeData.push({action:o.PROTOCOL_ACTION.DELETE_BG_IMG_ACTION,seq:this.getSeq()}),this.report.reportImage(this.currentBoard,"")},m.prototype.clearGlobalBgColor=function(){this.setGlobalBackgroundColor(this.options.globalBackgroundColor)},m.prototype.switchBoard=function(t){if(this.cancelSelect(),t&&!this.data[t])return console.error("没有这一页白板"),!1;t||(t=this.createBoardId(),this.addBoard(t)),this.currentBoard=t;var e=this.backgroundPic[this.currentBoard]?this.backgroundPic[this.currentBoard].url:"";e&&this.realTimeData.push({action:o.PROTOCOL_ACTION.UPDATE_BG_IMG_ACTION,url:e,time:s.getAVSdkTimestamp(),seq:a.getSeq(),mode:0,cleanBoard:0}),this.realTimeData.push({action:o.PROTOCOL_ACTION.SWITCH_ACTION,time:s.getAVSdkTimestamp(),seq:a.getSeq(),toBoardId:t,deleteBoards:[]}),this.sendRequest(),this.report.reportSwitchBoard(t),l.fire(this,n.EVENT.SWITCH_BOARD,{current:this.currentBoard,list:this.boardList}),this.needDraw=!0},m.prototype.setGlobalBackgroundColor=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.COLOR.WHITE,r=arguments[1],i=0;"number"==typeof e?(this.globalBackgroundColor=s.dealColor(e),i=e):"string"!=typeof e||0!=e.indexOf("#")||4!==e.length&&7!==e.length||(this.globalBackgroundColor=s.hexToRgba(e),i=s.formatColor(s.hexToRgba(e))),this.boardList.forEach(function(e){t.backgroundColor[e]=t.globalBackgroundColor}),this.needDraw=!0,r||(this.realTimeData.push({action:o.PROTOCOL_ACTION.UPDATE_BG_COLOR_ACTION,time:s.getAVSdkTimestamp(),seq:a.getSeq(),color:i,isGlobal:1}),this.report.reportGlobalBgColor(i))},m.prototype.resetOperation=function(){this.opData[this.currentBoard]=this.opData[this.currentBoard].slice(0,this.opIndex[this.currentBoard])},m.prototype.collectLineData=function(){var t=this;return{start:function(e,r){var i=a.getSeq();t.belongLineSeq=i;var n=new c(t.identifier,{color:t.color,thin:t.thin,x:e,y:r,show:!0,seq:i,belongSeq:i});t.userData[t.currentBoard][t.identifier].push(n),t.data[t.currentBoard].push(n),t.opData[t.currentBoard].push(new d(t.identifier,{seq:n.seq,type:t.type})),t.opIndex[t.currentBoard]++;var l={action:o.PROTOCOL_ACTION.LINE_START_ACTION,color:s.formatColor(n.color),scale:100,thin:n.thin,time:s.getAVSdkTimestamp(),seq:n.seq,belongSeq:n.belongSeq,x:e,y:r};t.realTimeData.push(l)},draw:function(e,r){var i=t.userData[t.currentBoard][t.identifier].length,n=t.userData[t.currentBoard][t.identifier][i-1];n.setBorder(e,r);var s=a.getSeq();n.lines.push({x:e,y:r,seq:s});var l={action:o.PROTOCOL_ACTION.LINE_MOVE_ACTION,seq:s,belongSeq:t.belongLineSeq,x:e,y:r};t.realTimeData.push(l)},end:function(e,r){var i=t.userData[t.currentBoard][t.identifier].length,n=t.userData[t.currentBoard][t.identifier][i-1];n.setBorder(e,r);var l=a.getSeq();n.lines.push({x:e,y:r,seq:l});var d={action:o.PROTOCOL_ACTION.LINE_END_ACTION,belongSeq:t.belongLineSeq,seq:l,x:e,y:r};t.realTimeData.push(d);var c=[];n.lines.forEach(function(t){c.push({seq:t.seq,x:t.x,y:t.y})}),t.report.reportAddLine({boardId:t.currentBoard,uid:t.identifier,colorRGBA:s.formatColor(t.color),scale:100,width:t.thin,time:n.time,updateTime:s.getTimeStamp(),seq:n.seq,hidden:0,points:c})},over:function(t,e){this.end(t,e)}}},m.prototype.collectEraserData=function(t,e){var r=this.eraserImpactCheck(t,e,this.radius);if(r.length>0){this.opData[this.currentBoard].push(new d("",{seq:r,type:this.type})),this.opIndex[this.currentBoard]++;var i={action:o.PROTOCOL_ACTION.ERASER_ACTION,display:0,time:s.getAVSdkTimestamp(),seq:a.getSeq(),x:0,y:0,lines:r};r.length&&(this.realTimeData.push(i),this.report.reportDisplayLine({boardId:this.currentBoard,updateTime:s.getTimeStamp(),display:0,lines:r})),this.needDraw=!0}},m.prototype.collectRaserData=function(){var t=this;return{start:function(e,r){var i=new p(t.identifier,{color:s.dealColor(n.COLOR.RED),radius:t.thin,x:e,y:r,seq:a.getSeq()});t.seq=i.seq,t.userData[t.currentBoard][t.identifier].push(i),t.data[t.currentBoard].push(i);var l={action:o.PROTOCOL_ACTION.RASER_SHOW_ACTION,r:t.thin,seq:i.seq,x:e,y:r};t.realTimeData.push(l),t.needDraw=!0},draw:function(e,r){var i=t.userData[t.currentBoard][t.identifier].length;t.userData[t.currentBoard][t.identifier][i-1].location={x:e,y:r},t.needDraw=!0,t.realTimeData.push({action:o.PROTOCOL_ACTION.RASER_SHOW_ACTION,seq:a.getSeq(),x:e,y:r,r:t.thin})},end:function(e,r){var i=t.userData[t.currentBoard][t.identifier].length,n=t.userData[t.currentBoard][t.identifier][i-1];n.point={x:e,y:r},n.status=0;var s={action:o.PROTOCOL_ACTION.RASER_HIDE_ACTION,seq:n.seq};t.realTimeData.push(s),t.needDraw=!0},over:function(){var t=this.userData[this.currentBoard][this.identifier].length;this.userData[this.currentBoard][this.identifier][t-1].status=0,this.needDraw=!0}}},m.prototype.collectSelectData=function(){var t=this;return{start:function(e,r){t.beforeMoveType="select";var i=new h(t.identifier,{startx:e,starty:r,x:e,y:r});t.seq=i.seq,t.userData[t.currentBoard][t.identifier].push(i),t.data[t.currentBoard].push(i)},draw:function(e,r){var i=t.userData[t.currentBoard][t.identifier].length;t.userData[t.currentBoard][t.identifier][i-1].location={x:e,y:r},t.needDraw=!0},end:function(e,r,i,o){for(var n=e>i?e:i,s=r>o?r:o,a=e+i-n,l=r+o-s,d=t.data[t.currentBoard].length-1;d>=0;d--){var c=t.data[t.currentBoard][d];"line"==c.type&&c.show?n>=c.border.maxX&&s>=c.border.maxY&&a<=c.border.minX&&l<=c.border.minY&&(c.select=!0,t.selectedList.push(c)):"graph"==c.type&&c.show&&n>=c.endPoint.x&&s>=c.endPoint.y&&a<=c.startPoint.x&&l<=c.startPoint.y&&(c.select=!0,t.selectedList.push(c))}t.selectArea={x:a,y:l,width:n-a,height:s-l},t.userData[t.currentBoard][t.identifier][t.userData[t.currentBoard][t.identifier].length-1].show=!1,t.needDraw=!0,t.selectedList.length&&t.setType("move")}}},m.prototype.collectPointSelectData=function(t,e){this.beforeMoveType="pointselect";for(var r=!1,i=this.data[this.currentBoard].length-1;i>=0;i--){var o=this.data[this.currentBoard][i];if("line"==o.type&&o.show){if(t<o.border.maxX&&t>o.border.minX&&e<o.border.maxY&&e>o.border.minY){r=!0,o.select=!0,this.selectedList=[o],this.selectArea={x:o.border.minX,y:o.border.minY,width:o.border.maxX-o.border.minX,height:o.border.maxY-o.border.minY};break}}else if("graph"==o.type&&o.show){var n=o.endPoint.x,s=o.endPoint.y,a=o.startPoint.x,l=o.startPoint.y;if(n<a&&(n+=a,n-=a=n-a),s<l&&(s+=l,s-=l=s-l),s+=this.thin,n+=this.thin,a-=this.thin,l-=this.thin,t>=a&&t<=n&&e>=l&&e<=s){r=!0,o.select=!0,this.selectedList=[o],this.selectArea={x:a,y:l,width:n-a,height:s-l};break}}}r&&(this.needDraw=!0,this.setType("move"))},m.prototype.collectMoverData=function(){var t=this;return{beforeStart:function(e,r){if(0==t.selectedList.length)return!1;for(var i=!1,o=0;o<t.selectedList.length;o++){var n=t.selectedList[o];if("line"==n.type){if(n.border.minX<=e&&n.border.maxX>=e&&n.border.minY<=r&&n.border.maxY>=r){i=!0;break}}else if("graph"==n.type){var s=n.startPoint.x,a=n.endPoint.x,l=n.startPoint.y,d=n.endPoint.y;if(a<s&&(a+=s,a-=s=a-s),d<l&&(d+=l,d-=l=d-l),d+=t.thin,a+=t.thin,l-=t.thin,(s-=t.thin)<=e&&a>=e&&l<=r&&d>=r){i=!0;break}}}return!!i||(t.setType(t.beforeMoveType),t.cancelSelect(),t.needDraw=!0,!1)},start:function(e,r){var i=[];t.selectedList.forEach(function(t){"line"==t.type?i.push({uid:t.user,seq:t.seq,x:t.lines[0].x,y:t.lines[0].y}):"graph"==t.type&&i.push({uid:t.user,seq:t.startPoint.seq,x:t.startPoint.x,y:t.startPoint.y})}),t.opData[t.currentBoard].push(new d("",{seq:{origin:i,final:[]},type:t.type}))},draw:function(e,r,i,o){if(t.selectedList.length>0){for(var n=0;n<t.selectedList.length;n++){var s=t.selectedList[n],a=e-i,l=r-o;"line"==s.type?(s.border.maxX+=a,s.border.minX+=a,s.border.maxY+=l,s.border.minY+=l,s.lines.forEach(function(t){t.x+=a,t.y+=l})):"graph"==s.type&&(s.startPoint.x+=a,s.startPoint.y+=l,s.endPoint.x+=a,s.endPoint.y+=l)}t.selectArea.x+=a,t.selectArea.y+=l,t.needDraw=!0}},end:function(){t.needDraw=!0;var e=[];if(0!=t.selectedList.length){t.selectedList.forEach(function(t){"line"==t.type?e.push({seq:t.seq,x:t.lines[0].x,y:t.lines[0].y,uid:t.user}):"graph"==t.type&&e.push({seq:t.startPoint.seq,x:t.startPoint.x,y:t.startPoint.y,uid:t.user})});var r={action:o.PROTOCOL_ACTION.MOVE_LINE_GRAPH_ACTION,seq:a.getSeq(),moves:e,time:s.getAVSdkTimestamp()};t.realTimeData.push(r);var i=[];t.selectedList.forEach(function(t){"line"==t.type?i.push({uid:t.user,seq:t.seq,x:t.lines[0].x,y:t.lines[0].y}):"graph"==t.type&&i.push({uid:t.user,seq:t.startPoint.seq,x:t.startPoint.x,y:t.startPoint.y})}),t.opData[t.currentBoard][t.opData[t.currentBoard].length-1].seq.final=i,t.opIndex[t.currentBoard]++;var n=[];e.forEach(function(e){for(var r=e.uid,i=0;i<t.userData[t.currentBoard][r].length;i++){var o=t.userData[t.currentBoard][r][i];if("line"==o.type&&e.seq==o.seq){var l=[];o.lines.forEach(function(t){l.push({seq:t.seq,x:t.x,y:t.y})}),n.push({type:"addLine",seq:a.getSeq(),content:{boardId:t.currentBoard,uid:o.user,colorRGBA:s.formatColor(o.color),scale:100,width:o.thin,time:o.time,updateTime:s.getTimeStamp(),seq:o.seq,hidden:0,points:l}})}else if("graph"==o.type&&e.seq==o.startPoint.seq){var d={type:{line:"addPatternLine",oval:"addPatternCircle",circle:"addPatternCircle",rect:"addPatternRectangle"}[o.graph],seq:a.getSeq(),content:{boardId:t.currentBoard,uid:t.identifier,colorRGBA:s.formatColor(o.color),scale:100,width:o.thin,time:o.time,updateTime:s.getTimeStamp(),hidden:0,beginPoint:{x:o.startPoint.x,y:o.startPoint.y,seq:o.startPoint.seq},endPoint:{x:o.endPoint.x,y:o.endPoint.y,seq:o.endPoint.seq}}};"oval"==o.graph||"circle"==o.graph?(d.content.fillRect=0,d.content.fillRect=o.solid?1:0):"rect"==o.graph&&(d.content.fillRect=0,d.content.fillRect=o.solid?1:0,d.content.cornerRadius=0),n.push(d)}}}),t.report.reportGraphData(n),t.setType(t.beforeMoveType)}}}},m.prototype.collectGraphData=function(){var t=this;return{start:function(e,r){var i=t.type.split("-")[1],o=new u(t.identifier,{graph:i,color:t.color,thin:t.thin,seq:a.getSeq(),beginPoint:{x:e,y:r,seq:a.getSeq()},endPoint:{x:e,y:r,seq:a.getSeq()},show:!0,solid:t.type.indexOf("solid")>-1});t.seq=o.seq,t.userData[t.currentBoard][t.identifier].push(o),t.data[t.currentBoard].push(o),t.opData[t.currentBoard].push(new d(t.identifier,{seq:o.startPoint.seq,type:"graph"})),t.opIndex[t.currentBoard]++},draw:function(e,r){var i=t.userData[t.currentBoard][t.identifier].length,o=t.userData[t.currentBoard][t.identifier][i-1];o.endPoint.x=e,o.endPoint.y=r,"circle"==o.graph&&t.circleFix(o),t.needDraw=!0},end:function(e,r){var i=t.userData[t.currentBoard][t.identifier].length,o=t.userData[t.currentBoard][t.identifier][i-1];o.endPoint.x=e,o.endPoint.y=r,"circle"==o.graph&&t.circleFix(o),"line"!=o.graph&&t.graphFix(o),t.needDraw=!0;var n={seq:o.seq,time:s.getAVSdkTimestamp(),color:s.formatColor(t.color),scale:100,thin:t.thin,beginPoint:{x:o.startPoint.x,y:o.startPoint.y,seq:o.startPoint.seq},endPoint:{x:o.endPoint.x,y:o.endPoint.y,seq:o.endPoint.seq}};n.action={line:10,oval:11,circle:11,rect:12}[o.graph];var l={type:{line:"addPatternLine",oval:"addPatternCircle",circle:"addPatternCircle",rect:"addPatternRectangle"}[o.graph],seq:a.getSeq(),content:{boardId:t.currentBoard,uid:t.identifier,colorRGBA:s.formatColor(t.color),scale:100,width:t.thin,time:o.time,updateTime:s.getTimeStamp(),hidden:0,beginPoint:{x:o.startPoint.x,y:o.startPoint.y,seq:o.startPoint.seq},endPoint:{x:o.endPoint.x,y:o.endPoint.y,seq:o.endPoint.seq}}},d=t.type.indexOf("solid")>-1?1:0;n.action>10&&(n.fillRect=d,l.content.fillRect=d),12==n.action&&(n.cornerRadius=0,l.content.cornerRadius=0),t.realTimeData.push(n),t.report.reportGraphData([l])},over:function(t,e){this.end(t,e)}}},m.prototype.cancelSelect=function(){for(var t=0;t<this.selectedList.length;t++){this.selectedList[t].select=!1}this.selectedList=[],this.selectArea={x:0,y:0,width:0,height:0},this.needDraw=!0},m.prototype.eraserImpactCheck=function(t,e,r){var i=this,o=[];return this.data[this.currentBoard].forEach(function(n){if("line"==n.type&&n.show){var s=!1,a=n.border.maxX,l=n.border.maxY,d=n.border.minX,c=n.border.minY;if(a>=t&&l>=e&&d<=t&&c<=e)s=!0;else if(a>=t&&d<=t){(v=Math.min(Math.abs(l-e),Math.abs(c-e)))<=r&&(s=!0)}else if(l>=e&&c<=e){(v=Math.min(Math.abs(a-t),Math.abs(d-t)))<=r&&(s=!0)}else if(a<t){(v=l<e?Math.pow(t-a,2)+Math.pow(e-l,2):Math.pow(t-a,2)+Math.pow(e-c,2))<=Math.pow(r,2)&&(s=!0)}else{(v=l<e?Math.pow(t-d,2)+Math.pow(e-l,2):Math.pow(t-d,2)+Math.pow(e-c,2))<=Math.pow(r,2)&&(s=!0)}if(!s)return;s=!1;for(var u=1;u<n.lines.length;u++){var h=n.lines[u],p=n.lines[u-1];if((v=i.getDistance(t,e,h.x,h.y,p.x,p.y))<=(r+i.thin)*(r+i.thin)){s=!0;break}}s&&(n.show=!1,o.push({uid:n.user,seq:n.seq}))}else if("graph"==n.type&&n.show){if("line"==n.graph)(v=i.getDistance(t,e,n.startPoint.x,n.startPoint.y,n.endPoint.x,n.endPoint.y))<=(r+i.thin)*(r+i.thin)&&(n.show=!1,o.push({uid:n.user,seq:n.startPoint.seq}));else if("rect"==n.graph)if(n.solid)t>n.startPoint.x&&e>n.startPoint.y&&t<n.endPoint.x&&e<n.endPoint.y&&(n.show=!1,o.push({uid:n.user,seq:n.startPoint.seq}));else{var f=i.getDistance(t,e,n.startPoint.x,n.startPoint.y,n.startPoint.x,n.endPoint.y),g=i.getDistance(t,e,n.startPoint.x,n.startPoint.y,n.endPoint.x,n.startPoint.y),_=i.getDistance(t,e,n.endPoint.x,n.endPoint.y,n.startPoint.x,n.endPoint.y),m=i.getDistance(t,e,n.endPoint.x,n.endPoint.y,n.endPoint.x,n.startPoint.y);Math.min(f,g,_,m)<=(r+i.thin)*(r+i.thin)&&(n.show=!1,o.push({uid:n.user,seq:n.startPoint.seq}))}else if("circle"==n.graph){var y=(n.startPoint.x+n.endPoint.x)/2,b=(n.startPoint.y+n.endPoint.y)/2,E=Math.sqrt(Math.pow(n.startPoint.x-n.endPoint.x,2)+Math.pow(n.startPoint.y-n.endPoint.y,2))/2,v=Math.sqrt(Math.pow(t-y,2)+Math.pow(e-b,2));n.solid?v<E+r&&(n.show=!1,o.push({uid:n.user,seq:n.startPoint.seq})):Math.abs(E-v)<=r+i.thin&&(n.show=!1,o.push({uid:n.user,seq:n.startPoint.seq}))}else if("oval"==n.graph){y=(n.startPoint.x+n.endPoint.x)/2,b=(n.startPoint.y+n.endPoint.y)/2;var T=Math.abs(n.startPoint.x-n.endPoint.x)/2,D=Math.abs(n.startPoint.y-n.endPoint.y)/2;if(T===D&&0===T)return;var S=Math.pow(t-y,2)/Math.pow(T,2)+Math.pow(e-b,2)/Math.pow(D,2),A=Math.pow(t-y+i.thin/2,2)/Math.pow(T,2)+Math.pow(e-b+i.thin/2,2)/Math.pow(D,2),B=Math.pow(t-y+i.thin/2,2)/Math.pow(T,2)+Math.pow(e-b-i.thin/2,2)/Math.pow(D,2),w=Math.pow(t-y-i.thin/2,2)/Math.pow(T,2)+Math.pow(e-b+i.thin/2,2)/Math.pow(D,2),C=Math.pow(t-y-i.thin/2,2)/Math.pow(T,2)+Math.pow(e-b-i.thin/2,2)/Math.pow(D,2);n.solid?(S<=1.2||A<=1.2||B<=1.2||w<=1.2||C<=1.2)&&(n.show=!1,o.push({uid:n.user,seq:n.startPoint.seq})):(S<=1.2&&S>=.8||A<=1.2&&A>=.8||B<=1.2&&B>=.8||w<=1.2&&w>=.8||C<=1.2&&C>=.8)&&(n.show=!1,o.push({uid:n.user,seq:n.startPoint.seq}))}}}),o},m.prototype.getDistance=function(t,e,r,i,o,n){var s={};if(r==o)s.x=r,s.y=e;else{var a=(i-n)/(r-o),l=i-a*r,d=t+a*e;s.x=(d-a*l)/(a*a+1),s.y=a*s.x+l}return s.x>=r&&s.x<=o||s.x<=r&&s.x>=o?(s.x-t)*(s.x-t)+(s.y-e)*(s.y-e):Math.min((r-t)*(r-t)+(i-e)*(i-e),(o-t)*(o-t)+(n-e)*(n-e))},m.prototype.circleFix=function(t){var e=Math.abs(t.startPoint.x-t.endPoint.x)*this.boardWidth/1e4,r=Math.abs(t.startPoint.y-t.endPoint.y)*this.boardHeight/1e4;e>r?(t.endPoint.x=t.startPoint.x<t.endPoint.x?t.startPoint.x+1e4*r/this.boardWidth:t.startPoint.x-1e4*r/this.boardWidth,t.endPoint.x=parseInt(t.endPoint.x)):(t.endPoint.y=t.startPoint.y<t.endPoint.y?t.startPoint.y+1e4*e/this.boardHeight:t.startPoint.y-1e4*e/this.boardHeight,t.endPoint.y=parseInt(t.endPoint.y))},m.prototype.graphFix=function(t){var e=t.startPoint.x,r=t.startPoint.y,i=t.endPoint.x,o=t.endPoint.y;t.startPoint={x:e>i?i:e,y:r>o?o:r,seq:t.startPoint.seq},t.endPoint={x:e>i?e:i,y:r>o?r:o,seq:t.endPoint.seq}},m.prototype.sendRequest=function(){if(this.permissions){var t=JSON.parse(JSON.stringify(this.realTimeData)),e={seq:a.getSeq(),timestamp:s.getAVSdkTimestamp(),value:{boardId:this.currentBoard,operator:this.identifier,actions:t}};this.realTimeData=[],l.fire(this,n.EVENT.RT_DATA,e)}},m.prototype.sendRequestSpecial=function(t,e){var r={seq:a.getSeq(),timestamp:s.getAVSdkTimestamp(),value:{boardId:t,operator:this.identifier,actions:e}};l.fire(this,n.EVENT.RT_DATA,r)},m.prototype.addHistory=function(t){var e=this,r=this;this.sortBoard(),console.log(t),t.forEach(function(t){var i,o;if(t.content=JSON.parse(t.content),"setGlobalBG"===t.type);else if("createBoards"===t.type)t.content&&t.content.createBoards.forEach(function(t){(i=t)&&!r.userData[i]&&r.addBoard(i,!1)});else if("addFile"===t.type){for(var a=t.content.fid,d=t.content.title,h=t.content.downloadURL,p=t.content.pageCount,f=t.content.currentPageIndex,g=!1,m=0,y=r.groups.length;m<y;m++){var b=r.groups[m];if(b.fid==b){g=!0;break}}g||r.groups.push({fid:a,title:d,downloadURL:h,pageCount:p,currentPageIndex:f})}else i=t.content.boardId,o=t.content.uid,i&&!r.userData[i]&&r.addBoard(i,!1),i&&!r.userData[i][o]&&(r.userData[i][o]=[]);if(t.content.colorRGBA&&(t.content.color=s.dealColor(t.content.colorRGBA)),t.content.width&&(t.content.thin=t.content.width),"addLine"==t.type){var E;for(m=0;m<t.content.points.length-1;m++){var v=t.content.points[m].x,T=t.content.points[m].y,D=t.content.points[0].seq;0==m?E=new c(o,{color:t.content.color,thin:t.content.thin,x:v,y:T,seq:t.content.points[m].seq,belongSeq:D,show:!t.content.hidden}):(E.lines.push({x:v,y:T,belongSeq:D,seq:t.content.points[m].seq}),E.sort(),m==t.content.points.length-1&&(E.endSeq=t.content.points[m].seq)),E.setBorder(v,T)}E&&(r.userData[i][o].push(E),r.data[i].push(E))}else if("displayLine"==t.type){t.content.lines.forEach(function(e){for(var i=0;i<r.userData[r.currentBoard][o].length;i++){var n=r.userData[r.currentBoard][o][i];"line"==n.type&&n.startSeq==e.seq?n.show=!!t.content.display:"graph"==n.type&&n.startPoint.seq==e.seq&&(n.show=!!t.content.display)}})}else if("addPatternLine"==t.type||"addPatternCircle"==t.type||"addPatternRectangle"==t.type){t.content.graph={addPatternLine:"line",addPatternCircle:"oval",addPatternRectangle:"rect"}[t.type],t.content.beginPoint.x=t.content.beginPoint.x,t.content.endPoint.x=t.content.endPoint.x,t.content.beginPoint.y=t.content.beginPoint.y,t.content.endPoint.y=t.content.endPoint.y,t.content.seq=t.content.beginPoint.seq,t.content.show=!t.content.hidden,t.content.solid=!!t.content.fillRect;var S=new u(o,t.content);r.userData[i][o].push(S),r.data[i].push(S)}else if("image"==t.type)t.content.url?r.addBackgroundPic(t.content.boardId,t.content.url,!1,!1):r.deleteBackgroundPic(t.content.boardId);else if("clean"==t.type)r.clearBoard(!1);else if("cleanDraws"==t.type)r.clearBoard(!0);else if("switchBoard"==t.type){if(!i)return;(1*t.seq||0)>r.maxSeq?(r.maxSeq=t.seq,r.data[i]||r.addBoard(i,!1),r.currentBoard=i,l.fire(e,n.EVENT.SWITCH_BOARD,{current:i,list:r.boardList})):_.report("throw_seq",{extra_info:JSON.stringify({seq:t.seq,maxSeq:r.maxSeq,boardId:i,method:"addHistory"})})}else"setBoardBG"==t.type?r.setBackgroundColor({boardId:i,color:t.content.colorRGBA},!0):"setGlobalBG"==t.type&&r.setGlobalBackgroundColor(t.content.colorRGBA,!0)}),r.needDraw=!0},m.prototype.undo=function(){var t=this;this.cancelSelect();var e=this.opData[this.currentBoard][this.opIndex[this.currentBoard]-1];if(e){if("line"==e.type)for(var r=0;r<this.userData[this.currentBoard][e.user].length;r++){var i=this.userData[this.currentBoard][e.user][r];if(e.seq==i.seq){i.show=!1,this.realTimeData.push({action:o.PROTOCOL_ACTION.ERASER_ACTION,display:0,time:s.getAVSdkTimestamp(),seq:a.getSeq(),lines:[{uid:e.user,seq:e.seq}]}),this.report.reportDisplayLine({boardId:this.currentBoard,updateTime:s.getTimeStamp(),display:0,lines:[{uid:e.user,seq:e.seq}]});break}}else if("eraser"==e.type)e.seq.forEach(function(e){for(var r=e.uid,i=0;i<t.userData[t.currentBoard][r].length;i++){var o=t.userData[t.currentBoard][r][i];"line"==o.type&&e.seq==o.seq?o.show=!0:"graph"==o.type&&e.seq==o.startPoint.seq&&(o.show=!0)}}),this.realTimeData.push({action:o.PROTOCOL_ACTION.ERASER_ACTION,display:1,time:s.getAVSdkTimestamp(),seq:a.getSeq(),lines:e.seq}),this.report.reportDisplayLine({boardId:this.currentBoard,updateTime:s.getTimeStamp(),display:1,lines:e.seq});else if("graph"==e.type)for(r=0;r<this.userData[this.currentBoard][e.user].length;r++){if("graph"==(i=this.userData[this.currentBoard][e.user][r]).type&&e.seq==i.startPoint.seq){i.show=!1,this.realTimeData.push({action:o.PROTOCOL_ACTION.ERASER_ACTION,display:0,time:s.getAVSdkTimestamp(),seq:a.getSeq(),lines:[{uid:e.user,seq:e.seq}]}),this.report.reportDisplayLine({boardId:this.currentBoard,updateTime:s.getTimeStamp(),display:0,lines:[{uid:e.user,seq:e.seq}]});break}}else if("move"==e.type){var n=[];e.seq.origin.forEach(function(e){for(var r=e.uid,i=0;i<t.userData[t.currentBoard][r].length;i++){var o=t.userData[t.currentBoard][r][i];if("line"==o.type&&e.seq==o.seq){var s=e.x-o.lines[0].x,a=e.y-o.lines[0].y;o.border.maxX+=s,o.border.minX+=s,o.border.maxY+=a,o.border.minY+=a,o.lines.forEach(function(t){t.x+=s,t.y+=a}),n.push({uid:r,seq:e.seq,x:e.x,y:e.y})}else if("graph"==o.type&&e.seq==o.startPoint.seq){s=e.x-o.startPoint.x,a=e.y-o.startPoint.y;o.startPoint.x+=s,o.startPoint.y+=a,o.endPoint.x+=s,o.endPoint.y+=a,n.push({uid:r,seq:e.seq,x:e.x,y:e.y})}}}),this.realTimeData.push({action:o.PROTOCOL_ACTION.MOVE_LINE_GRAPH_ACTION,time:s.getAVSdkTimestamp(),seq:a.getSeq(),moves:n});var l=[];e.seq.origin.forEach(function(e){for(var r=e.uid,i=0;i<t.userData[t.currentBoard][r].length;i++){var o=t.userData[t.currentBoard][r][i];if("line"==o.type&&e.seq==o.seq){var n=[];o.lines.forEach(function(t){n.push({seq:t.seq,x:t.x,y:t.y})}),l.push({type:"addLine",seq:a.getSeq(),content:{boardId:t.currentBoard,uid:o.user,colorRGBA:s.formatColor(o.color),scale:100,width:o.thin,time:o.time,updateTime:s.getTimeStamp(),seq:o.seq,hidden:0,points:n}})}else if("graph"==o.type&&e.seq==o.startPoint.seq){var d={type:{line:"addPatternLine",oval:"addPatternCircle",circle:"addPatternCircle",rect:"addPatternRectangle"}[o.graph],seq:a.getSeq(),content:{boardId:t.currentBoard,uid:t.identifier,colorRGBA:s.formatColor(o.color),scale:100,width:o.thin,time:o.time,updateTime:s.getTimeStamp(),hidden:0,beginPoint:{x:o.startPoint.x,y:o.startPoint.y,seq:o.startPoint.seq},endPoint:{x:o.endPoint.x,y:o.endPoint.y,seq:o.endPoint.seq}}};"oval"==o.graph||"circle"==o.graph?d.content.fillRect=0:"rect"==o.graph&&(d.content.fillRect=0,d.content.cornerRadius=0),l.push(d)}}}),this.report.reportGraphData(l)}this.opIndex[this.currentBoard]--,this.needDraw=!0}},m.prototype.canUndo=function(){return 0!=this.opIndex[this.currentBoard]},m.prototype.redo=function(){var t=this;this.cancelSelect();var e=this.opData[this.currentBoard][this.opIndex[this.currentBoard]];if(e){if("line"==e.type)for(var r=0;r<this.userData[this.currentBoard][e.user].length;r++){var i=this.userData[this.currentBoard][e.user][r];if(e.seq==i.seq){i.show=!0,this.realTimeData.push({action:o.PROTOCOL_ACTION.ERASER_ACTION,display:1,time:s.getAVSdkTimestamp(),seq:a.getSeq(),lines:[{uid:e.user,seq:e.seq}]}),this.report.reportDisplayLine({boardId:this.currentBoard,updateTime:s.getTimeStamp(),display:1,lines:[{uid:e.user,seq:e.seq}]});break}}else if("eraser"==e.type)e.seq.forEach(function(e){for(var r=e.uid,i=0;i<t.userData[t.currentBoard][r].length;i++){var o=t.userData[t.currentBoard][r][i];"line"==o.type&&e.seq==o.seq?o.show=!1:"graph"==o.type&&e.seq==o.startPoint.seq&&(o.show=!1)}}),this.realTimeData.push({action:o.PROTOCOL_ACTION.ERASER_ACTION,display:0,time:s.getAVSdkTimestamp(),seq:a.getSeq(),lines:e.seq}),this.report.reportDisplayLine({boardId:this.currentBoard,updateTime:s.getTimeStamp(),display:0,lines:e.seq});else if("graph"==e.type)for(r=0;r<this.userData[this.currentBoard][e.user].length;r++){if("graph"==(i=this.userData[this.currentBoard][e.user][r]).type&&e.seq==i.startPoint.seq){i.show=!0,this.realTimeData.push({action:o.PROTOCOL_ACTION.ERASER_ACTION,display:1,time:s.getAVSdkTimestamp(),seq:a.getSeq(),lines:[{uid:e.user,seq:e.seq}]}),this.report.reportDisplayLine({boardId:this.currentBoard,updateTime:s.getTimeStamp(),display:1,lines:[{uid:e.user,seq:e.seq}]});break}}else if("move"==e.type){var n=[];e.seq.final.forEach(function(e){for(var r=e.uid,i=0;i<t.userData[t.currentBoard][r].length;i++){var o=t.userData[t.currentBoard][r][i];if("line"==o.type&&e.seq==o.seq){var s=e.x-o.lines[0].x,a=e.y-o.lines[0].y;o.border.maxX+=s,o.border.minX+=s,o.border.maxY+=a,o.border.minY+=a,o.lines.forEach(function(t){t.x+=s,t.y+=a}),n.push({uid:r,seq:e.seq,x:e.x,y:e.y})}else if("graph"==o.type&&e.seq==o.startPoint.seq){s=e.x-o.startPoint.x,a=e.y-o.startPoint.y;o.startPoint.x+=s,o.startPoint.y+=a,o.endPoint.x+=s,o.endPoint.y+=a,n.push({uid:r,seq:e.seq,x:e.x,y:e.y})}}}),this.realTimeData.push({action:o.PROTOCOL_ACTION.MOVE_LINE_GRAPH_ACTION,time:s.getAVSdkTimestamp(),seq:a.getSeq(),moves:n});var l=[];e.seq.final.forEach(function(e){for(var r=e.uid,i=0;i<t.userData[t.currentBoard][r].length;i++){var o=t.userData[t.currentBoard][r][i];if("line"==o.type&&e.seq==o.seq){var n=[];o.lines.forEach(function(t){n.push({seq:t.seq,x:t.x,y:t.y})}),l.push({type:"addLine",seq:a.getSeq(),content:{boardId:t.currentBoard,uid:o.user,colorRGBA:s.formatColor(o.color),scale:100,width:o.thin,time:o.time,updateTime:s.getTimeStamp(),seq:o.seq,hidden:0,points:n}})}else if("graph"==o.type&&e.seq==o.startPoint.seq){var d={type:{line:"addPatternLine",oval:"addPatternCircle",circle:"addPatternCircle",rect:"addPatternRectangle"}[o.graph],seq:a.getSeq(),content:{boardId:t.currentBoard,uid:t.identifier,colorRGBA:s.formatColor(o.color),scale:100,width:o.thin,time:o.time,updateTime:s.getTimeStamp(),hidden:0,beginPoint:{x:o.startPoint.x,y:o.startPoint.y,seq:o.startPoint.seq},endPoint:{x:o.endPoint.x,y:o.endPoint.y,seq:o.endPoint.seq}}};"oval"==o.graph||"circle"==o.graph?d.content.fillRect=0:"rect"==o.graph&&(d.content.fillRect=0,d.content.cornerRadius=0),l.push(d)}}}),this.report.reportGraphData(l)}this.opIndex[this.currentBoard]++,this.needDraw=!0}},m.prototype.canRedo=function(){return this.opIndex[this.currentBoard]!=this.opData[this.currentBoard].length},m.prototype.syncHistroyData=function(){var t=this,e=this;e.clearBoard();var r=[],i=[],o=0;return new Promise(function(s,a){!function e(n,s){var a=(new Date).getTime();new Promise(function(e,r){t.request.getBoardData(function(t){t.error_code?(_.report("getBoardData",{action_result:t.error_code,action_info:t.error_msg,time_consume:(new Date).getTime()-a,extra_info:JSON.stringify(t)}),r("error_code:"+t.error_code+" error_msg:"+t.error_msg)):(_.report("getBoardData",{time_consume:(new Date).getTime()-a,extra_info:JSON.stringify(t)}),e(t))},function(t){r("error_code:"+t+" error_msg:HTTP请求错误，请重试")})}).then(function(t){(t.board_data_list||[]).forEach(function(t){"setGlobalBG"===t.type?r.push(t):i.push(t)}),o++,!t.is_finish&&o<500?e(n,s):n()}).catch(function(t){console.error("恢复课堂：",t)})}(function(){e.addHistory(r),e.addHistory(i),e.sortBoard(),e.syncBoardSeq(),l.fire(this,n.EVENT.HISTROY_DATA_COMPLETE)})})},m.prototype.sortBoard=function(){this.boardList=this.boardList.sort(function(t,e){return(t===o.COMMON_DEFAULT_BOARD?0:t.match(/\d+_#\w+$/)[0].split("_")[0])-(e===o.COMMON_DEFAULT_BOARD?0:e.match(/\d+_#\w+$/)[0].split("_")[0])})},m.prototype.syncBoardSeq=function(){1==this.boardList.length&&this.boardList[0]===o.COMMON_DEFAULT_BOARD?this.boardIdSeq=1:this.boardList[this.boardList.length-1]&&(this.boardIdSeq=1*this.boardList[this.boardList.length-1].match(/\d+_#\w+$/)[0].split("_")[0]+1)},m.prototype.addData=function(t){var e=this;if(this.permissions){_.report("addData",{extra_info:JSON.stringify(t)});var r=t.value.operator,i=t.value.actions,o=t.value.boardId;this.userData[o]||this.addBoard(o,!1),this.userData[o][r]||(this.userData[o][r]=[]);this.userData[o][r].length;i.forEach(function(t){if(t.color&&(t.color=s.dealColor(t.color)),1==t.action)(i=e.findLine(o,r,t))?(i.color=t.color,i.thin=t.thin,i.show=!0,i.lines.push({x:t.x,y:t.y,belongSeq:t.belongSeq,seq:t.seq}),i.sort(),i.setBorder(t.x,t.y)):((i=new c(r,t)).show=!0,e.userData[o][r].push(i),e.data[o].push(i));else if(2==t.action||3==t.action){var i;(i=e.findLine(o,r,t))?(i.lines.push({x:t.x,y:t.y,belongSeq:t.belongSeq,seq:t.seq}),i.sort(),i.setBorder(t.x,t.y)):(i=new c(r,t),e.userData[o][r].push(i),e.data[o].push(i)),3==t.action&&(i.endSeq=t.seq,function(t,r){setTimeout(function(){t.color&&t.thin||e.request.getLineData({boardId:r,owner:t.user,seq:t.belongSeq},function(t){t.error_code||(e.addHistory([{content:t.content,type:t.type}]),e.sortBoard(),e.syncBoardSeq())})},500)}(i,o))}else if(6==t.action){e.userData[o][r].forEach(function(t){"raser"==t.type&&(t.status=0)});var d=new p(e.identifier,{color:t.color,radius:e.thin,x:t.x,y:t.y,seq:a.getSeq()});e.userData[o][r].push(d),e.data[o].push(d)}else if(7==t.action)e.userData[o][r].forEach(function(t){"raser"==t.type&&(t.status=0)});else if(8==t.action){if(!t.lines)return;t.lines.forEach(function(r){for(var i=0;i<e.userData[o][r.uid].length;i++){var n=e.userData[o][r.uid][i];"line"==n.type&&n.startSeq==r.seq?n.show=!!t.display:"graph"==n.type&&n.startPoint.seq==r.seq&&(n.show=!!t.display)}})}else if(9==t.action){if(!t.moves)return;t.moves.forEach(function(t){t.x=t.x,t.y=t.y;for(var r=0;r<e.userData[o][t.uid].length;r++){var i=e.userData[o][t.uid][r];if("line"==i.type&&i.startSeq==t.seq){var n=t.x-i.lines[0].x,s=t.y-i.lines[0].y;i.border.maxX+=n,i.border.minX+=n,i.border.maxY+=s,i.border.minY+=s,i.lines.forEach(function(t){t.x+=n,t.y+=s})}else if("graph"==i.type&&i.startPoint.seq==t.seq){n=t.x-i.startPoint.x,s=t.y-i.startPoint.y;i.startPoint.x+=n,i.startPoint.y+=s,i.endPoint.x+=n,i.endPoint.y+=s}}})}else if(10==t.action||11==t.action||12==t.action){t.graph={10:"line",11:"oval",12:"rect"}[t.action],t.beginPoint.x=t.beginPoint.x,t.endPoint.x=t.endPoint.x,t.beginPoint.y=t.beginPoint.y,t.endPoint.y=t.endPoint.y,t.solid=!!t.fillRect,t.show=!0;var h=new u(r,t);e.userData[o][r].push(h),e.data[o].push(h),0}else if(101==t.action)e.clearBoard(!1);else if(102==t.action)e.clearBoard(!0);else if(103==t.action)try{e.clearFileDrawData(t.fids)}catch(t){}else if(201==t.action)e.addBackgroundPic(o,t.url,!1);else if(202==t.action)e.deleteBackgroundPic(o);else if(203==t.action)t.color&&(t.color=s.formatColor(t.color)),t.isGlobal?e.setGlobalBackgroundColor(t.color,!0):e.setBackgroundColor(t.color,!0);else if(401==t.action){var f=t.toBoardId;if((1*t.seq||0)>e.maxSeq){e.maxSeq=t.seq;var g=t.deleteFiles||[],m=t.deleteBoards||[];g.forEach(function(t){m.contact(e.getBoardByGroup(t))}),m.forEach(function(t){e.removeBoard(t)}),e.data[f]||e.addBoard(f,!1),e.currentBoard=f,l.fire(e,n.EVENT.SWITCH_BOARD,{current:f,list:e.boardList})}else _.report("throw_seq",{extra_info:JSON.stringify({seq:t.seq,maxSeq:self.maxSeq,boardId:f,method:"addData"})})}}),this.needDraw=!0}},m.prototype.addFile=function(t,e,r){var i=this;if(Array.isArray(t)){var o="#"+s.getTimeStamp(),n=[];return t.forEach(function(){n.push(i.createBoardId(o))}),this.addGroup(o,e,r),this.addBoard(n),this.addBackgroundPic(n,t),setTimeout(function(){n.length&&i.switchBoard(n[0])},200),o}},m.prototype.deleteFile=function(t){var e=this.deleteGroup(t);return l.fire(this,n.EVENT.DELETE_FILE,t),!!e&&(this.deleteBoard(e),!0)},m.prototype.switchFile=function(t){for(var e=!1,r=0,i=this.groups.length;r<i;r++){var o=this.groups[r];if(o.fid==o){e=!0;break}}return e?(this.currentGroup=t,l.fire(this,n.EVENT.SWITCH_FILE,t),t):(console.log("不存在该白板组"),!1)},m.prototype.setBoardSize=function(t,e){this.boardWidth=t,this.boardHeight=e},t.exports=m},,function(t,e,r){"use strict";var i=r(14),o=r(1),n=r(2),s=r(0),a=r(3),l=r(15);function d(t){this.board=new i(t),this.fileCos=new l(t),this.version=o.VERSION,console.log("当前白板版本：",this.version)}d.CONSTANT={EVENT:a.EVENT},d.DRAW_TYPE={LINE:"line",ERASER:"eraser",RASER:"raser",POINTSELECT:"pointselect",SELECT:"select",GRAPH_LINE:"graph-line",GRAPH_CIRCLE:"graph-circle",GRAPH_RECT:"graph-rect",GRAPH_OVAL:"graph-oval",GRAPH_CIRCLE_SOLID:"graph-circle-solid",GRAPH_RECT_SOLID:"graph-rect-solid",GRAPH_OVAL_SOLID:"graph-oval-solid"},d.prototype.resize=function(){this.board.resize()},d.prototype.getBoardData=function(){return this.board.getBoardData()},d.prototype.getBoardPicList=function(){return this.board.getBoardPicList()},d.prototype.addData=function(t){this.board.addData(t)},d.prototype.addBoard=function(){this.board.switchBoard()},d.prototype.deleteBoard=function(t){this.board.deleteBoard(t)},d.prototype.prevBoard=function(){this.board.prevBoard()},d.prototype.nextBoard=function(){this.board.nextBoard()},d.prototype.getBoardList=function(){return this.board.getBoardList()},d.prototype.getCurrentBoard=function(){return this.board.getCurrentBoard()},d.prototype.getCurrentFile=function(){return this.board.getCurrentFile()},d.prototype.switchBoard=function(t){t?this.board.switchBoard(t):console.error("boardId 不能为空")},d.prototype.setGlobalBackgroundColor=function(t){this.board.setGlobalBackgroundColor(t)},d.prototype.setBackgroundColor=function(t){this.board.setBackgroundColor(t)},d.prototype.setColor=function(t){this.board.setColor(t)},d.prototype.setThin=function(t){this.board.setThin(t)},d.prototype.setRadius=function(t){this.board.setRadius(t)},d.prototype.setType=function(t){this.board.setType(t)},d.prototype.undo=function(){this.board.undo()},d.prototype.canUndo=function(){return this.board.canUndo()},d.prototype.redo=function(){this.board.redo()},d.prototype.canRedo=function(){return this.board.canRedo()},d.prototype.clear=function(){this.board.clear()},d.prototype.clearDraws=function(){this.board.clearDraws()},d.prototype.clearAll=function(){this.board.clearAll()},d.prototype.setBackgroundPic=function(t){this.board.setBackgroundPic(t)},d.prototype.clearBackgroundPic=function(){this.board.cancelBackgroundPic()},d.prototype.clearGlobalBgColor=function(){this.board.clearGlobalBgColor()},d.prototype.cancelSelect=function(){this.board.cancelSelect()},d.prototype.on=function(t,e){n.on(t,e)},d.prototype.off=function(t,e){n.off(t,e)},d.prototype.addFileUrl=function(t,e){return this.board.addFile(t,e)},d.prototype.addFile=function(t,e,r){var i=this;this.fileCos.uploadFile(t,function(t,r){i.board.addFile(r.picUrls,r.fileName),e&&e(t,r)},function(t){r&&r(t)})},d.prototype.addImgFile=function(t,e,r){var i=this;this.fileCos.uploadFile(t,function(t,r){i.board.setBackgroundPic(r),e&&e(t,r)},function(t){r&&r(t)})},d.prototype.deleteFile=function(t){this.board.deleteFile(t)},d.prototype.switchFile=function(t){this.board.switchFile(t)},d.prototype.getAllFileInfo=function(){return this.board.getGroup()},d.prototype.getBoardByFile=function(t){return this.board.getBoardByGroup(t)},d.prototype.setCanDraw=function(t){return this.board.setCanDraw(t)},d.prototype.addBackgroundPic=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.board.createBoradId();return this.board.addBackgroundPic(r,t),e&&this.switchBoard(r),r},d.prototype.clearFileDraws=function(t){this.board.clearFileDraws(t)},d.prototype.getCosInstance=function(){return this.fileCos.cos},d.prototype.draw=function(){this.board.draw()},d.prototype.dealColor=function(t){return s.dealColor(t)},d.prototype.formatColor=function(t){return s.formatColor(t)},d.prototype.revert=function(){this.undo()},d.prototype.canRevert=function(){return this.canUndo()},d.prototype.process=function(){this.redo()},d.prototype.canProcess=function(){return this.canRedo()},t.exports=d},,function(t,e,r){"use strict";function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var o=r(5),n=r(0),s=r(4);function a(t){this.request=t}a.prototype.reportCreateBoards=function(t,e){var r=[];r=Array.isArray(e)?e:[e];var i=(new Date).getTime();this.request.reportMsg([{type:"createBoards",seq:o.getSeq(),content:{createBoards:r,updateTime:n.getTimeStamp()}}],function(e){e.ErrorCode||e.error_code?s.boardAction("createBoards",{action_result:e.ErrorCode?"ErrorCode:"+e.ErrorCode:"error_code:"+e.error_code,action_info:e.ErrorInfo||e.error_msg,time_consume:n.getTimeDiff(i),boardid:t,boardid_list:r,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null}):s.boardAction("createBoards",{action_result:0,action_info:null,time_consume:n.getTimeDiff(i),boardid:t,boardid_list:r,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null})},function(e){s.boardAction("createBoards",{action_result:-9999,action_info:e&&e.message,time_consume:n.getTimeDiff(i),boardid:t,boardid_list:r,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null})})},a.prototype.reportDeleteBoard=function(t,e){var r=(new Date).getTime();this.request.reportMsg([{type:"deleteBoards",seq:o.getSeq(),content:{deleteBoards:t,toBoardId:e,updateTime:n.getTimeStamp()}}],function(i){i.ErrorCode||i.error_code?s.boardAction("deleteBoards",{action_result:i.ErrorCode?"ErrorCode:"+i.ErrorCode:"error_code:"+i.error_code,action_info:i.ErrorInfo||i.error_msg,time_consume:n.getTimeDiff(r),boardid:null,boardid_list:t,image_url:null,to_boardId:e,color:null,file_id:null,file_title:null}):s.boardAction("deleteBoards",{action_result:0,action_info:null,time_consume:n.getTimeDiff(r),boardid:null,boardid_list:t,image_url:null,to_boardId:e,color:null,file_id:null,file_title:null})},function(i){s.boardAction("deleteBoards",{action_result:-9999,action_info:i&&i.message,time_consume:n.getTimeDiff(r),boardid:null,boardid_list:t,image_url:null,to_boardId:e,color:null,file_id:null,file_title:null})})},a.prototype.reportSetBoardBgColor=function(t,e){var r=(new Date).getTime();this.request.reportMsg([{type:"setBoardBG",seq:o.getSeq(),content:{boardId:t,updateTime:n.getTimeStamp(),colorRGBA:e}}],function(i){i.ErrorCode||i.error_code?s.boardAction("setBoardBG",{action_result:i.ErrorCode?"ErrorCode:"+i.ErrorCode:"error_code:"+i.error_code,action_info:i.ErrorInfo||i.error_msg,time_consume:n.getTimeDiff(r),boardid:t,boardid_list:null,image_url:null,to_boardId:null,color:e,file_id:null,file_title:null}):s.boardAction("setBoardBG",{action_result:0,action_info:null,time_consume:n.getTimeDiff(r),boardid:t,boardid_list:null,image_url:null,to_boardId:null,color:e,file_id:null,file_title:null})},function(i){s.boardAction("setBoardBG",{action_result:-9999,action_info:i&&i.message,time_consume:n.getTimeDiff(r),boardid:t,boardid_list:null,image_url:null,to_boardId:null,color:e,file_id:null,file_title:null})})},a.prototype.reportClear=function(t){var e=(new Date).getTime();this.request.reportMsg([{type:"clean",seq:o.getSeq(),content:{boardId:t,updateTime:n.getTimeStamp()}}],function(r){r.ErrorCode||r.error_code?s.boardAction("clean",{action_result:r.ErrorCode?"ErrorCode:"+r.ErrorCode:"error_code:"+r.error_code,action_info:r.ErrorInfo||r.error_msg,time_consume:n.getTimeDiff(e),boardid:t,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null}):s.boardAction("clean",{action_result:0,action_info:null,time_consume:n.getTimeDiff(e),boardid:t,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null})},function(r){s.boardAction("clean",{action_result:-9999,action_info:r&&r.message,time_consume:n.getTimeDiff(e),boardid:t,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null})})},a.prototype.reportClearDraws=function(t){var e=(new Date).getTime();this.request.reportMsg([{type:"cleanDraws",seq:o.getSeq(),content:{boardId:t,updateTime:n.getTimeStamp()}}],function(r){r.ErrorCode||r.error_code?s.boardAction("cleanDraws",{action_result:r.ErrorCode?"ErrorCode:"+r.ErrorCode:"error_code:"+r.error_code,action_info:r.ErrorInfo||r.error_msg,time_consume:n.getTimeDiff(e),boardid:t,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null}):s.boardAction("cleanDraws",{action_result:0,action_info:null,time_consume:n.getTimeDiff(e),boardid:t,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null})},function(r){s.boardAction("cleanDraws",{action_result:-9999,action_info:r&&r.message,time_consume:n.getTimeDiff(e),boardid:t,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null})})},a.prototype.reportImage=function(t,e){var r=(new Date).getTime();this.request.reportMsg([{type:"image",seq:o.getSeq(),content:{boardId:t,url:e,updateTime:n.getTimeStamp(),mode:0}}],function(o){var a,l,d={};(d[t]=e,o.ErrorCode||o.error_code)?s.boardAction("image",(i(a={action_result:o.ErrorCode?"ErrorCode:"+o.ErrorCode:"error_code:"+o.error_code,action_info:o.ErrorInfo||o.error_msg,time_consume:n.getTimeDiff(r),boardid:null,boardid_list:null},"boardid_list",[d]),i(a,"to_boardId",null),i(a,"color",null),i(a,"file_id",null),i(a,"file_title",null),a)):s.boardAction("image",(i(l={action_result:0,action_info:null,time_consume:n.getTimeDiff(r),boardid:null,boardid_list:null},"boardid_list",[d]),i(l,"to_boardId",null),i(l,"color",null),i(l,"file_id",null),i(l,"file_title",null),l))},function(t){var e;s.boardAction("image",(i(e={action_result:-9999,action_info:t&&t.message,time_consume:n.getTimeDiff(r),boardid:null,boardid_list:null},"boardid_list",[boardInfo]),i(e,"to_boardId",null),i(e,"color",null),i(e,"file_id",null),i(e,"file_title",null),e))})},a.prototype.reportImages=function(t){var e=(new Date).getTime();this.request.reportMsg(t,function(r){var o,a,l=[];(t.forEach(function(t){var e={};e[t.content.boardId]=t.content.url,l.push(e)}),r.ErrorCode||r.error_code)?s.boardAction("image",(i(o={action_result:r.ErrorCode?"ErrorCode:"+r.ErrorCode:"error_code:"+r.error_code,action_info:r.ErrorInfo||r.error_msg,time_consume:n.getTimeDiff(e),boardid:null,boardid_list:null},"boardid_list",l),i(o,"to_boardId",null),i(o,"color",null),i(o,"file_id",null),i(o,"file_title",null),o)):s.boardAction("image",(i(a={action_result:0,action_info:null,time_consume:n.getTimeDiff(e),boardid:null,boardid_list:null},"boardid_list",l),i(a,"to_boardId",null),i(a,"color",null),i(a,"file_id",null),i(a,"file_title",null),a))},function(t){var r;s.boardAction("image",(i(r={action_result:-9999,action_info:t&&t.message,time_consume:n.getTimeDiff(e),boardid:null,boardid_list:null},"boardid_list",boardInfoList),i(r,"to_boardId",null),i(r,"color",null),i(r,"file_id",null),i(r,"file_title",null),r))})},a.prototype.reportSwitchBoard=function(t){var e=(new Date).getTime();this.request.reportMsg([{type:"switchBoard",seq:o.getSeq(),content:{boardId:t,updateTime:n.getTimeStamp()}}],function(r){r.ErrorCode||r.error_code?s.boardAction("switchBoard",{action_result:r.ErrorCode?"ErrorCode:"+r.ErrorCode:"error_code:"+r.error_code,action_info:r.ErrorInfo||r.error_msg,time_consume:n.getTimeDiff(e),boardid:t,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null}):s.boardAction("switchBoard",{action_result:0,action_info:null,time_consume:n.getTimeDiff(e),boardid:t,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null})},function(r){s.boardAction("switchBoard",{action_result:-9999,action_info:r&&r.message,time_consume:n.getTimeDiff(e),boardid:t,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null})})},a.prototype.reportGlobalBgColor=function(t){var e=(new Date).getTime();this.request.reportMsg([{type:"setGlobalBG",seq:o.getSeq(),content:{updateTime:n.getTimeStamp(),colorRGBA:t}}],function(r){r.ErrorCode||r.error_code?s.boardAction("setGlobalBG",{action_result:r.ErrorCode?"ErrorCode:"+r.ErrorCode:"error_code:"+r.error_code,action_info:r.ErrorInfo||r.error_msg,time_consume:n.getTimeDiff(e),boardid:null,boardid_list:null,image_url:null,to_boardId:null,color:t,file_id:null,file_title:null}):s.boardAction("setGlobalBG",{action_result:0,action_info:null,time_consume:n.getTimeDiff(e),boardid:null,boardid_list:null,image_url:null,to_boardId:null,color:t,file_id:null,file_title:null})},function(r){s.boardAction("setGlobalBG",{action_result:-9999,action_info:r&&r.message,time_consume:n.getTimeDiff(e),boardid:null,boardid_list:null,image_url:null,to_boardId:null,color:t,file_id:null,file_title:null})})},a.prototype.reportAddLine=function(t){var e=(new Date).getTime();this.request.reportMsg([{type:"addLine",seq:o.getSeq(),content:t}],function(r){r.ErrorCode||r.error_code?s.boardAction("addLine",{action_result:r.ErrorCode?"ErrorCode:"+r.ErrorCode:"error_code:"+r.error_code,action_info:r.ErrorInfo||r.error_msg,time_consume:n.getTimeDiff(e),boardid:t.boardId,boardid_list:null,image_url:null,to_boardId:null,color:t.colorRGBA,file_id:null,file_title:null}):s.boardAction("addLine",{action_result:0,action_info:null,time_consume:n.getTimeDiff(e),boardid:t.boardId,boardid_list:null,image_url:null,to_boardId:null,color:t.colorRGBA,file_id:null,file_title:null})},function(r){s.boardAction("addLine",{action_result:-9999,action_info:r&&r.message,time_consume:n.getTimeDiff(e),boardid:t.boardId,boardid_list:null,image_url:null,to_boardId:null,color:t.colorRGBA,file_id:null,file_title:null})})},a.prototype.reportDisplayLine=function(t){var e=(new Date).getTime();this.request.reportMsg([{type:"displayLine",seq:o.getSeq(),content:t}],function(r){r.ErrorCode||r.error_code?s.boardAction("displayLine",{action_result:r.ErrorCode?"ErrorCode:"+r.ErrorCode:"error_code:"+r.error_code,action_info:r.ErrorInfo||r.error_msg,time_consume:n.getTimeDiff(e),boardid:t.boardId,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null,display:t.display}):s.boardAction("displayLine",{action_result:0,action_info:null,time_consume:n.getTimeDiff(e),boardid:t.boardId,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null,display:t.display})},function(r){s.boardAction("displayLine",{action_result:-9999,action_info:r&&r.message,time_consume:n.getTimeDiff(e),boardid:t.boardId,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null,display:t.display})})},a.prototype.reportGraphData=function(t){var e=(new Date).getTime();this.request.reportMsg(t,function(r){t.forEach(function(t){var o,a;r.ErrorCode||r.error_code?s.boardAction(t.type,(i(o={action_result:r.ErrorCode?"ErrorCode:"+r.ErrorCode:"error_code:"+r.error_code,action_info:r.ErrorInfo||r.error_msg,time_consume:n.getTimeDiff(e),boardid:t.content.boardId,boardid_list:null},"boardid_list",null),i(o,"to_boardId",null),i(o,"color",t.content.colorRGBA),i(o,"file_id",null),i(o,"file_title",null),o)):s.boardAction(t.type,(i(a={action_result:0,action_info:null,time_consume:n.getTimeDiff(e),boardid:t.content.boardId,boardid_list:null},"boardid_list",null),i(a,"to_boardId",null),i(a,"color",t.content.colorRGBA),i(a,"file_id",null),i(a,"file_title",null),a))})},function(r){t.forEach(function(t){var o;s.boardAction(t.type,(i(o={action_result:-9999,action_info:r&&r.message,time_consume:n.getTimeDiff(e),boardid:t.content.boardId,boardid_list:null},"boardid_list",boardInfoList),i(o,"to_boardId",null),i(o,"color",t.content.colorRGBA),i(o,"file_id",null),i(o,"file_title",null),o))})})},a.prototype.reportAddFile=function(t,e){var r=(new Date).getTime();this.request.reportMsg([{type:"addFile",seq:o.getSeq(),content:{updateTime:n.getTimeStamp(),fid:t,title:e}}],function(i){i.ErrorCode||i.error_code?s.boardAction("addFile",{action_result:i.ErrorCode?"ErrorCode:"+i.ErrorCode:"error_code:"+i.error_code,action_info:i.ErrorInfo||i.error_msg,time_consume:n.getTimeDiff(r),boardid:null,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:t,file_title:e}):s.boardAction("addFile",{action_result:0,action_info:null,time_consume:n.getTimeDiff(r),boardid:null,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:t,file_title:e})},function(i){s.boardAction("addFile",{action_result:-9999,action_info:i&&i.message,time_consume:n.getTimeDiff(r),boardid:null,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:t,file_title:e})})},a.prototype.reportDeleteFile=function(t){var e=(new Date).getTime();this.request.reportMsg([{type:"deleteFile",seq:o.getSeq(),content:{fid:t,updateTime:n.getTimeStamp()}}],function(r){r.ErrorCode||r.error_code?s.boardAction("deleteFile",{action_result:r.ErrorCode?"ErrorCode:"+r.ErrorCode:"error_code:"+r.error_code,action_info:r.ErrorInfo||r.error_msg,time_consume:n.getTimeDiff(e),boardid:null,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:t,file_title:null}):s.boardAction("deleteFile",{action_result:0,action_info:null,time_consume:n.getTimeDiff(e),boardid:null,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:t,file_title:null})},function(r){s.boardAction("deleteFile",{action_result:-9999,action_info:r&&r.message,time_consume:n.getTimeDiff(e),boardid:null,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:t,file_title:null})})},a.prototype.reportCleanAll=function(){var t=(new Date).getTime();this.request.reportMsg([{type:"cleanAll",seq:o.getSeq()}],function(e){e.ErrorCode||e.error_code?s.boardAction("cleanAll",{action_result:e.ErrorCode?"ErrorCode:"+e.ErrorCode:"error_code:"+e.error_code,action_info:e.ErrorInfo||e.error_msg,time_consume:n.getTimeDiff(t),boardid:null,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null}):s.boardAction("cleanAll",{action_result:0,action_info:null,time_consume:n.getTimeDiff(t),boardid:null,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null})},function(e){s.boardAction("cleanAll",{action_result:-9999,action_info:e&&e.message,time_consume:n.getTimeDiff(t),boardid:null,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null})})},t.exports=a},,,function(module,exports,__webpack_require__){(function(process,global){var __WEBPACK_AMD_DEFINE_RESULT__;
    /**
     * [js-md5]{@link https://github.com/emn178/js-md5}
     *
     * @namespace md5
     * @version 0.7.3
     * @author Chen, Yi-Cyuan [emn178@gmail.com]
     * @copyright Chen, Yi-Cyuan 2014-2017
     * @license MIT
     */
    /**
     * [js-md5]{@link https://github.com/emn178/js-md5}
     *
     * @namespace md5
     * @version 0.7.3
     * @author Chen, Yi-Cyuan [emn178@gmail.com]
     * @copyright Chen, Yi-Cyuan 2014-2017
     * @license MIT
     */
    !function(){"use strict";var ERROR="input is invalid type",WINDOW="object"==typeof window,root=WINDOW?window:{};root.JS_MD5_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"==typeof self,NODE_JS=!root.JS_MD5_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS?root=global:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_MD5_NO_COMMON_JS&&"object"==typeof module&&module.exports,AMD=__webpack_require__(26),ARRAY_BUFFER=!root.JS_MD5_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[128,32768,8388608,-2147483648],SHIFT=[0,8,16,24],OUTPUT_TYPES=["hex","array","digest","buffer","arrayBuffer","base64"],BASE64_ENCODE_CHAR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),blocks=[],buffer8;if(ARRAY_BUFFER){var buffer=new ArrayBuffer(68);buffer8=new Uint8Array(buffer),blocks=new Uint32Array(buffer)}!root.JS_MD5_NO_NODE_JS&&Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),!ARRAY_BUFFER||!root.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(t){return"object"==typeof t&&t.buffer&&t.buffer.constructor===ArrayBuffer});var createOutputMethod=function(t){return function(e){return new Md5(!0).update(e)[t]()}},createMethod=function(){var t=createOutputMethod("hex");NODE_JS&&(t=nodeWrap(t)),t.create=function(){return new Md5},t.update=function(e){return t.create().update(e)};for(var e=0;e<OUTPUT_TYPES.length;++e){var r=OUTPUT_TYPES[e];t[r]=createOutputMethod(r)}return t},nodeWrap=function(method){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),nodeMethod=function(t){if("string"==typeof t)return crypto.createHash("md5").update(t,"utf8").digest("hex");if(null===t||void 0===t)throw ERROR;return t.constructor===ArrayBuffer&&(t=new Uint8Array(t)),Array.isArray(t)||ArrayBuffer.isView(t)||t.constructor===Buffer?crypto.createHash("md5").update(new Buffer(t)).digest("hex"):method(t)};return nodeMethod};function Md5(t){if(t)blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks,this.buffer8=buffer8;else if(ARRAY_BUFFER){var e=new ArrayBuffer(68);this.buffer8=new Uint8Array(e),this.blocks=new Uint32Array(e)}else this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Md5.prototype.update=function(t){if(!this.finalized){var e,r=typeof t;if("string"!==r){if("object"!==r)throw ERROR;if(null===t)throw ERROR;if(ARRAY_BUFFER&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!(Array.isArray(t)||ARRAY_BUFFER&&ArrayBuffer.isView(t)))throw ERROR;e=!0}for(var i,o,n=0,s=t.length,a=this.blocks,l=this.buffer8;n<s;){if(this.hashed&&(this.hashed=!1,a[0]=a[16],a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0),e)if(ARRAY_BUFFER)for(o=this.start;n<s&&o<64;++n)l[o++]=t[n];else for(o=this.start;n<s&&o<64;++n)a[o>>2]|=t[n]<<SHIFT[3&o++];else if(ARRAY_BUFFER)for(o=this.start;n<s&&o<64;++n)(i=t.charCodeAt(n))<128?l[o++]=i:i<2048?(l[o++]=192|i>>6,l[o++]=128|63&i):i<55296||i>=57344?(l[o++]=224|i>>12,l[o++]=128|i>>6&63,l[o++]=128|63&i):(i=65536+((1023&i)<<10|1023&t.charCodeAt(++n)),l[o++]=240|i>>18,l[o++]=128|i>>12&63,l[o++]=128|i>>6&63,l[o++]=128|63&i);else for(o=this.start;n<s&&o<64;++n)(i=t.charCodeAt(n))<128?a[o>>2]|=i<<SHIFT[3&o++]:i<2048?(a[o>>2]|=(192|i>>6)<<SHIFT[3&o++],a[o>>2]|=(128|63&i)<<SHIFT[3&o++]):i<55296||i>=57344?(a[o>>2]|=(224|i>>12)<<SHIFT[3&o++],a[o>>2]|=(128|i>>6&63)<<SHIFT[3&o++],a[o>>2]|=(128|63&i)<<SHIFT[3&o++]):(i=65536+((1023&i)<<10|1023&t.charCodeAt(++n)),a[o>>2]|=(240|i>>18)<<SHIFT[3&o++],a[o>>2]|=(128|i>>12&63)<<SHIFT[3&o++],a[o>>2]|=(128|i>>6&63)<<SHIFT[3&o++],a[o>>2]|=(128|63&i)<<SHIFT[3&o++]);this.lastByteIndex=o,this.bytes+=o-this.start,o>=64?(this.start=o-64,this.hash(),this.hashed=!0):this.start=o}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Md5.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex;t[e>>2]|=EXTRA[3&e],e>=56&&(this.hashed||this.hash(),t[0]=t[16],t[16]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=0),t[14]=this.bytes<<3,t[15]=this.hBytes<<3|this.bytes>>>29,this.hash()}},Md5.prototype.hash=function(){var t,e,r,i,o,n,s=this.blocks;this.first?e=((e=((t=((t=s[0]-680876937)<<7|t>>>25)-271733879<<0)^(r=((r=(-271733879^(i=((i=(-1732584194^2004318071&t)+s[1]-117830708)<<12|i>>>20)+t<<0)&(-271733879^t))+s[2]-1126478375)<<17|r>>>15)+i<<0)&(i^t))+s[3]-1316259209)<<22|e>>>10)+r<<0:(t=this.h0,e=this.h1,r=this.h2,e=((e+=((t=((t+=((i=this.h3)^e&(r^i))+s[0]-680876936)<<7|t>>>25)+e<<0)^(r=((r+=(e^(i=((i+=(r^t&(e^r))+s[1]-389564586)<<12|i>>>20)+t<<0)&(t^e))+s[2]+606105819)<<17|r>>>15)+i<<0)&(i^t))+s[3]-1044525330)<<22|e>>>10)+r<<0),e=((e+=((t=((t+=(i^e&(r^i))+s[4]-176418897)<<7|t>>>25)+e<<0)^(r=((r+=(e^(i=((i+=(r^t&(e^r))+s[5]+1200080426)<<12|i>>>20)+t<<0)&(t^e))+s[6]-1473231341)<<17|r>>>15)+i<<0)&(i^t))+s[7]-45705983)<<22|e>>>10)+r<<0,e=((e+=((t=((t+=(i^e&(r^i))+s[8]+1770035416)<<7|t>>>25)+e<<0)^(r=((r+=(e^(i=((i+=(r^t&(e^r))+s[9]-1958414417)<<12|i>>>20)+t<<0)&(t^e))+s[10]-42063)<<17|r>>>15)+i<<0)&(i^t))+s[11]-1990404162)<<22|e>>>10)+r<<0,e=((e+=((t=((t+=(i^e&(r^i))+s[12]+1804603682)<<7|t>>>25)+e<<0)^(r=((r+=(e^(i=((i+=(r^t&(e^r))+s[13]-40341101)<<12|i>>>20)+t<<0)&(t^e))+s[14]-1502002290)<<17|r>>>15)+i<<0)&(i^t))+s[15]+1236535329)<<22|e>>>10)+r<<0,e=((e+=((i=((i+=(e^r&((t=((t+=(r^i&(e^r))+s[1]-165796510)<<5|t>>>27)+e<<0)^e))+s[6]-1069501632)<<9|i>>>23)+t<<0)^t&((r=((r+=(t^e&(i^t))+s[11]+643717713)<<14|r>>>18)+i<<0)^i))+s[0]-373897302)<<20|e>>>12)+r<<0,e=((e+=((i=((i+=(e^r&((t=((t+=(r^i&(e^r))+s[5]-701558691)<<5|t>>>27)+e<<0)^e))+s[10]+38016083)<<9|i>>>23)+t<<0)^t&((r=((r+=(t^e&(i^t))+s[15]-660478335)<<14|r>>>18)+i<<0)^i))+s[4]-405537848)<<20|e>>>12)+r<<0,e=((e+=((i=((i+=(e^r&((t=((t+=(r^i&(e^r))+s[9]+568446438)<<5|t>>>27)+e<<0)^e))+s[14]-1019803690)<<9|i>>>23)+t<<0)^t&((r=((r+=(t^e&(i^t))+s[3]-187363961)<<14|r>>>18)+i<<0)^i))+s[8]+1163531501)<<20|e>>>12)+r<<0,e=((e+=((i=((i+=(e^r&((t=((t+=(r^i&(e^r))+s[13]-1444681467)<<5|t>>>27)+e<<0)^e))+s[2]-51403784)<<9|i>>>23)+t<<0)^t&((r=((r+=(t^e&(i^t))+s[7]+1735328473)<<14|r>>>18)+i<<0)^i))+s[12]-1926607734)<<20|e>>>12)+r<<0,e=((e+=((n=(i=((i+=((o=e^r)^(t=((t+=(o^i)+s[5]-378558)<<4|t>>>28)+e<<0))+s[8]-2022574463)<<11|i>>>21)+t<<0)^t)^(r=((r+=(n^e)+s[11]+1839030562)<<16|r>>>16)+i<<0))+s[14]-35309556)<<23|e>>>9)+r<<0,e=((e+=((n=(i=((i+=((o=e^r)^(t=((t+=(o^i)+s[1]-1530992060)<<4|t>>>28)+e<<0))+s[4]+1272893353)<<11|i>>>21)+t<<0)^t)^(r=((r+=(n^e)+s[7]-155497632)<<16|r>>>16)+i<<0))+s[10]-1094730640)<<23|e>>>9)+r<<0,e=((e+=((n=(i=((i+=((o=e^r)^(t=((t+=(o^i)+s[13]+681279174)<<4|t>>>28)+e<<0))+s[0]-358537222)<<11|i>>>21)+t<<0)^t)^(r=((r+=(n^e)+s[3]-722521979)<<16|r>>>16)+i<<0))+s[6]+76029189)<<23|e>>>9)+r<<0,e=((e+=((n=(i=((i+=((o=e^r)^(t=((t+=(o^i)+s[9]-640364487)<<4|t>>>28)+e<<0))+s[12]-421815835)<<11|i>>>21)+t<<0)^t)^(r=((r+=(n^e)+s[15]+530742520)<<16|r>>>16)+i<<0))+s[2]-995338651)<<23|e>>>9)+r<<0,e=((e+=((i=((i+=(e^((t=((t+=(r^(e|~i))+s[0]-198630844)<<6|t>>>26)+e<<0)|~r))+s[7]+1126891415)<<10|i>>>22)+t<<0)^((r=((r+=(t^(i|~e))+s[14]-1416354905)<<15|r>>>17)+i<<0)|~t))+s[5]-57434055)<<21|e>>>11)+r<<0,e=((e+=((i=((i+=(e^((t=((t+=(r^(e|~i))+s[12]+1700485571)<<6|t>>>26)+e<<0)|~r))+s[3]-1894986606)<<10|i>>>22)+t<<0)^((r=((r+=(t^(i|~e))+s[10]-1051523)<<15|r>>>17)+i<<0)|~t))+s[1]-2054922799)<<21|e>>>11)+r<<0,e=((e+=((i=((i+=(e^((t=((t+=(r^(e|~i))+s[8]+1873313359)<<6|t>>>26)+e<<0)|~r))+s[15]-30611744)<<10|i>>>22)+t<<0)^((r=((r+=(t^(i|~e))+s[6]-1560198380)<<15|r>>>17)+i<<0)|~t))+s[13]+1309151649)<<21|e>>>11)+r<<0,e=((e+=((i=((i+=(e^((t=((t+=(r^(e|~i))+s[4]-145523070)<<6|t>>>26)+e<<0)|~r))+s[11]-1120210379)<<10|i>>>22)+t<<0)^((r=((r+=(t^(i|~e))+s[2]+718787259)<<15|r>>>17)+i<<0)|~t))+s[9]-343485551)<<21|e>>>11)+r<<0,this.first?(this.h0=t+1732584193<<0,this.h1=e-271733879<<0,this.h2=r-1732584194<<0,this.h3=i+271733878<<0,this.first=!1):(this.h0=this.h0+t<<0,this.h1=this.h1+e<<0,this.h2=this.h2+r<<0,this.h3=this.h3+i<<0)},Md5.prototype.hex=function(){this.finalize();var t=this.h0,e=this.h1,r=this.h2,i=this.h3;return HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[15&r]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[15&i]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]},Md5.prototype.toString=Md5.prototype.hex,Md5.prototype.digest=function(){this.finalize();var t=this.h0,e=this.h1,r=this.h2,i=this.h3;return[255&t,t>>8&255,t>>16&255,t>>24&255,255&e,e>>8&255,e>>16&255,e>>24&255,255&r,r>>8&255,r>>16&255,r>>24&255,255&i,i>>8&255,i>>16&255,i>>24&255]},Md5.prototype.array=Md5.prototype.digest,Md5.prototype.arrayBuffer=function(){this.finalize();var t=new ArrayBuffer(16),e=new Uint32Array(t);return e[0]=this.h0,e[1]=this.h1,e[2]=this.h2,e[3]=this.h3,t},Md5.prototype.buffer=Md5.prototype.arrayBuffer,Md5.prototype.base64=function(){for(var t,e,r,i="",o=this.array(),n=0;n<15;)t=o[n++],e=o[n++],r=o[n++],i+=BASE64_ENCODE_CHAR[t>>>2]+BASE64_ENCODE_CHAR[63&(t<<4|e>>>4)]+BASE64_ENCODE_CHAR[63&(e<<2|r>>>6)]+BASE64_ENCODE_CHAR[63&r];return t=o[n],i+=BASE64_ENCODE_CHAR[t>>>2]+BASE64_ENCODE_CHAR[t<<4&63]+"=="};var exports=createMethod();COMMON_JS?module.exports=exports:(root.md5=exports,AMD&&(__WEBPACK_AMD_DEFINE_RESULT__=function(){return exports}.call(exports,__webpack_require__,exports,module),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)))}()}).call(exports,__webpack_require__(25),__webpack_require__(27))},function(t,e){var r,i,o=t.exports={};function n(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(r===setTimeout)return setTimeout(t,0);if((r===n||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:n}catch(t){r=n}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(t){i=s}}();var l,d=[],c=!1,u=-1;function h(){c&&l&&(c=!1,l.length?d=l.concat(d):u=-1,d.length&&p())}function p(){if(!c){var t=a(h);c=!0;for(var e=d.length;e;){for(l=d,d=[];++u<e;)l&&l[u].run();u=-1,e=d.length}l=null,c=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function g(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];d.push(new f(t,e)),1!==d.length||c||a(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e){(function(e){t.exports=e}).call(e,{})},function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r}])});
